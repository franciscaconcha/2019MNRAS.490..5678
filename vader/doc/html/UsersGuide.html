<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>User&#8217;s Guide for VADER v. 1.0</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="UsersGuide.tex"> 
<meta name="date" content="2014-06-20 12:52:00"> 
<link rel="stylesheet" type="text/css" href="UsersGuide.css"> 
</head><body 
>
       <div class="maketitle">
                                                                                         
                                                                                         
                                                                                         
                                                                                         

<h2 class="titleHead">User&#8217;s Guide for VADER&#x00A0;v.&#x00A0;1.0</h2>
<div class="author" ><span 
class="cmr-12x-x-120">Mark Krumholz</span></div>
<br />
<div class="date" ><span 
class="cmr-12x-x-120">June 20, 2014</span></div>
       </div>
       <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
       <div class="tableofcontents">
       <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">License and Citations</a></span>
<br />       <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">What Does <span 
class="cmtt-12">VADER </span>Do?</a></span>
<br />       <span class="sectionToc" >3 <a 
href="#x1-40003" id="QQ2-1-4">Installing and Configuring <span 
class="cmtt-12">VADER</span></a></span>
<br />       &#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-50003.1" id="QQ2-1-5">Getting <span 
class="cmtt-12">VADER</span></a></span>
<br />       &#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-60003.2" id="QQ2-1-6">Dependencies and Build Requirements</a></span>
<br />       <span class="sectionToc" >4 <a 
href="#x1-70004" id="QQ2-1-7">Structure of a <span 
class="cmtt-12">VADER </span>Simulation</a></span>
<br />       <span class="sectionToc" >5 <a 
href="#x1-80005" id="QQ2-1-8">Setting Up a New Problem</a></span>
<br />       &#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-90005.1" id="QQ2-1-9">The <span 
class="cmtt-12">userFunc </span>File</a></span>
<br />       &#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-100005.2" id="QQ2-1-10">The <span 
class="cmtt-12">main </span>File</a></span>
<br />       <span class="sectionToc" >6 <a 
href="#x1-110006" id="QQ2-1-11">Compiling <span 
class="cmtt-12">VADER</span></a></span>
<br />       &#x00A0;<span class="subsectionToc" >6.1 <a 
href="#x1-120006.1" id="QQ2-1-12">Executable Mode</a></span>
<br />       &#x00A0;<span class="subsectionToc" >6.2 <a 
href="#x1-130006.2" id="QQ2-1-13">Debug Mode</a></span>
<br />       &#x00A0;<span class="subsectionToc" >6.3 <a 
href="#x1-140006.3" id="QQ2-1-14">Dynamically-Linked Library Mode</a></span>
<br />       &#x00A0;<span class="subsectionToc" >6.4 <a 
href="#x1-150006.4" id="QQ2-1-15">Testing Mode</a></span>
<br />       <span class="sectionToc" >7 <a 
href="#x1-160007" id="QQ2-1-16">The Python Interface</a></span>
<br />       &#x00A0;<span class="subsectionToc" >7.1 <a 
href="#x1-170007.1" id="QQ2-1-17">Structure of a Python-Based <span 
class="cmtt-12">VADER </span>Simulation</a></span>
<br />       &#x00A0;<span class="subsectionToc" >7.2 <a 
href="#x1-180007.2" id="QQ2-1-18">Parameter Files</a></span>
<br />       <span class="sectionToc" >8 <a 
href="#x1-190008" id="QQ2-1-20">The <span 
class="cmtt-12">VADER </span>Test Suite</a></span>
<br />       <span class="sectionToc" >9 <a 
href="#x1-200009" id="QQ2-1-21">Full Description of All Routines and Data Structures</a></span>
<br />       &#x00A0;<span class="subsectionToc" >9.1 <a 
href="#x1-210009.1" id="QQ2-1-22">Core c Routines</a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.1 <a 
href="#x1-220009.1.1" id="QQ2-1-23">c Data Structures</a></span>
                                                                                         
                                                                                         
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.2 <a 
href="#x1-230009.1.2" id="QQ2-1-24"><span 
class="cmtt-12">advanceBE</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.3 <a 
href="#x1-240009.1.3" id="QQ2-1-25"><span 
class="cmtt-12">advanceCN</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.4 <a 
href="#x1-250009.1.4" id="QQ2-1-26"><span 
class="cmtt-12">applyBC</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.5 <a 
href="#x1-260009.1.5" id="QQ2-1-27"><span 
class="cmtt-12">driver</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.6 <a 
href="#x1-270009.1.6" id="QQ2-1-28"><span 
class="cmtt-12">gridAlloc</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.7 <a 
href="#x1-280009.1.7" id="QQ2-1-29"><span 
class="cmtt-12">gridFree</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.8 <a 
href="#x1-290009.1.8" id="QQ2-1-30"><span 
class="cmtt-12">gridInit</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.9 <a 
href="#x1-300009.1.9" id="QQ2-1-31"><span 
class="cmtt-12">gridInitFlat</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.10 <a 
href="#x1-310009.1.10" id="QQ2-1-32"><span 
class="cmtt-12">gridInitKeplerian</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.11 <a 
href="#x1-320009.1.11" id="QQ2-1-33"><span 
class="cmtt-12">gridInitTabulated</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.12 <a 
href="#x1-330009.1.12" id="QQ2-1-34"><span 
class="cmtt-12">ppmExtrap</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.13 <a 
href="#x1-340009.1.13" id="QQ2-1-35"><span 
class="cmtt-12">rotCurveSpline</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.14 <a 
href="#x1-350009.1.14" id="QQ2-1-36"><span 
class="cmtt-12">testingMode</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.15 <a 
href="#x1-360009.1.15" id="QQ2-1-37"><span 
class="cmtt-12">wkspAlloc</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.1.16 <a 
href="#x1-370009.1.16" id="QQ2-1-38"><span 
class="cmtt-12">wkspFree</span></a></span>
<br />       &#x00A0;<span class="subsectionToc" >9.2 <a 
href="#x1-380009.2" id="QQ2-1-39">User-Implemented c Routines</a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.2.1 <a 
href="#x1-390009.2.1" id="QQ2-1-40"><span 
class="cmtt-12">userAlpha</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.2.2 <a 
href="#x1-400009.2.2" id="QQ2-1-41"><span 
class="cmtt-12">userEOS</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.2.3 <a 
href="#x1-410009.2.3" id="QQ2-1-42"><span 
class="cmtt-12">userIBC</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.2.4 <a 
href="#x1-420009.2.4" id="QQ2-1-43"><span 
class="cmtt-12">userIntEnSrc</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.2.5 <a 
href="#x1-430009.2.5" id="QQ2-1-44"><span 
class="cmtt-12">userMassSrc</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.2.6 <a 
href="#x1-440009.2.6" id="QQ2-1-45"><span 
class="cmtt-12">userOBC</span></a></span>
<br />       &#x00A0;<span class="subsectionToc" >9.3 <a 
href="#x1-450009.3" id="QQ2-1-46">Python Routines</a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.1 <a 
href="#x1-460009.3.1" id="QQ2-1-47"><span 
class="cmtt-12">vader.advance</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.2 <a 
href="#x1-470009.3.2" id="QQ2-1-48"><span 
class="cmtt-12">vader.driver</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.3 <a 
href="#x1-480009.3.3" id="QQ2-1-49"><span 
class="cmtt-12">vader.grid</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.4 <a 
href="#x1-490009.3.4" id="QQ2-1-50"><span 
class="cmtt-12">vader.readParam</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.5 <a 
href="#x1-500009.3.5" id="QQ2-1-51"><span 
class="cmtt-12">vader.test.gidisk</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.6 <a 
href="#x1-510009.3.6" id="QQ2-1-52"><span 
class="cmtt-12">vader.test.ring</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.7 <a 
href="#x1-520009.3.7" id="QQ2-1-53"><span 
class="cmtt-12">vader.test.ringrad</span></a></span>
<br />       &#x00A0;&#x00A0;<span class="subsubsectionToc" >9.3.8 <a 
href="#x1-530009.3.8" id="QQ2-1-54"><span 
class="cmtt-12">vader.test.selfsim</span></a></span>
<br />       <span class="sectionToc" >10 <a 
href="#x1-5400010" id="QQ2-1-55">Revision History</a></span>
       </div>
                                                                                         
                                                                                         
       <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>License and Citations</h3>
<!--l. 29--><p class="noindent" >This is a guide for users of the <span 
class="cmtt-12">VADER</span>&#x00A0;software package. <span 
class="cmtt-12">VADER</span>&#x00A0;is distributed under the
terms of the <a 
href="http://www.gnu.org/licenses/gpl.html" >GNU General Public License v.&#x00A0;3</a>. A copy of the license notification is
included in the main <span 
class="cmtt-12">VADER</span>&#x00A0;directory. If you use <span 
class="cmtt-12">VADER</span>&#x00A0;in any published work, please
cite the paper Krumholz, M.&#x00A0;R., &amp; Forbes, J.&#x00A0;C., 2014, submitted to <span 
class="cmti-12">Astronomy &amp;</span>
<span 
class="cmti-12">Computing</span>.
<!--l. 32--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>What Does <span 
class="cmtt-12">VADER</span>&#x00A0;Do?</h3>
<!--l. 34--><p class="noindent" >A full description of the model system that <span 
class="cmtt-12">VADER</span>&#x00A0;simulates can be found in Krumholz, M.&#x00A0;R., &amp;
Forbes, J.&#x00A0;C., 2014, submitted to <span 
class="cmti-12">Astronomy &amp; Computing</span>. A short summary is that <span 
class="cmtt-12">VADER</span>&#x00A0;solves
the equations of mass, angular momentum, and energy conservation for a thin, axisymmetric,
viscous disk. These equations are <div class="eqnarray">
       <center class="math-display" >
<img 
src="UsersGuide0x.png" alt="                       -&#x2202;&#x03A3;  + 1-&#x2202;--(rvr&#x03A3;)  =   &#x02D9;&#x03A3;src                (1)
                       &#x2202;t     r &#x2202;(r      )
-&#x2202;-    1--&#x2202;-                1-&#x2202;-   v&#x03C6;T--       &#x02D9;
&#x2202;t E + r &#x2202;r [rvr (E + P )] - r&#x2202;r  r2&#x03C0;r2    =   Esrc.               (2)
" class="math-display" ><a 
 id="x1-3001r1"></a><a 
 id="x1-3001r2"></a></center>
</div>where <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> is the orbital velocity in the disk, &#x03A3;, <span 
class="cmmi-12">E</span>, and <span 
class="cmmi-12">P </span>are the vertically-integrated mass per unit
area, total energy per unit area (internal plus orbital plus potential), and pressure, <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-54.png" alt="T" class="10-120x-x-54" /> </span>is the
torque between adjacent rings of material, and <img 
src="UsersGuide1x.png" alt="&#x03A3;&#x02D9;"  class="dot" ><sub><span 
class="cmmi-8">src</span></sub> and <span 
class="cmmi-12">&#x0116;</span><sub><span 
class="cmmi-8">src</span></sub> are the source terms for
mass and total energy. The equations are written in a form where angular momentum
conservation has already been incorporated, so a separate conservation equation is not
needed for it. The radial velocity <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">r</span></sub> appear in these equations is related to the torque
by
       <table 
class="equation"><tr><td>
                                                                                         
                                                                                         
       <center class="math-display" >
<img 
src="UsersGuide2x.png" alt="            1        &#x2202;
vr = ------------------T ,
     2&#x03C0;r &#x03A3;v &#x03C6;(1 + &#x03B2; )&#x2202;r
" class="math-display" ><a 
 id="x1-3002r3"></a></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 45--><p class="nopar" >
where <span 
class="cmmi-12">&#x03B2; </span>= <span 
class="cmmi-12">&#x2202;</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;&#x2202;</span> ln <span 
class="cmmi-12">r </span>is the index of the rotation curve, and the torque is non-dimensionalized
via the standard <span 
class="cmmi-12">&#x03B1; </span>parameterization as
       <table 
class="equation"><tr><td>
       <center class="math-display" >
<img 
src="UsersGuide3x.png" alt="          2
T =  - 2 &#x03C0;r &#x03B1;(1 - &#x03B2;)P.
" class="math-display" ><a 
 id="x1-3003r4"></a></center></td><td class="equation-label">(4)</td></tr></table>
<!--l. 50--><p class="nopar" >
Finally, the system obeys a general equation of state whereby the vertically integrated pressure is a
function of the position, column density, and total internal energy,
       <table 
class="equation"><tr><td>
       <center class="math-display" >
<img 
src="UsersGuide4x.png" alt="P  = P (r,&#x03A3;,Eint)
" class="math-display" ><a 
 id="x1-3004r5"></a></center></td><td class="equation-label">(5)</td></tr></table>
<!--l. 54--><p class="nopar" >
where the internal energy is defined from the total energy and rotation curve by
       <table 
class="equation"><tr><td>
                                                                                         
                                                                                         
       <center class="math-display" >
<img 
src="UsersGuide5x.png" alt="      (        )
        v2&#x03C6;
E = &#x03A3;   ---+ &#x03C8;   + Eint,
         2
" class="math-display" ><a 
 id="x1-3005r6"></a></center></td><td class="equation-label">(6)</td></tr></table>
<!--l. 58--><p class="nopar" >
and <span 
class="cmmi-12">&#x03C8; </span>is the gravitational potential. The equation of state is characterize by two partial
derivatives, <div class="eqnarray">
       <center class="math-display" >
<img 
src="UsersGuide6x.png" alt="                 |
            &#x2202;P   ||
&#x03B3;  =   1 + ------||                                    (7)
           &#x2202;Eint r,&#x03A3;|
         1   &#x2202; lnP ||
&#x03B4;  =   ------------||     .                            (8)
       &#x03B3; - 1 &#x2202; ln&#x03A3;  r,Eint
" class="math-display" ></center>
</div><span 
class="cmtt-12">VADER</span>&#x00A0;solves this system of equations on an arbitrarily-arranged grid of radial cells
using a second-order accurate conservative finite volume method with implicit time
discretization.
<!--l. 67--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-40003"></a>Installing and Configuring <span 
class="cmtt-12">VADER</span></h3>
<!--l. 69--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-50003.1"></a>Getting <span 
class="cmtt-12">VADER</span></h4>
<!--l. 71--><p class="noindent" >The easiest way to get <span 
class="cmtt-12">VADER</span>&#x00A0;is from the public bitbucket repository. On any system with git
installed, <span 
class="cmtt-12">VADER</span>&#x00A0;may be downloaded via the command
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
git&#x00A0;clone&#x00A0;https://krumholz@bitbucket.org/krumholz/vader.git
</div>
</td></tr></table>
<!--l. 74--><p class="nopar" > The entire repository may also be downloaded as a zip file from <span class="obeylines-h"><a 
href="https://bitbucket.org/krumholz/vader/downloads" class="url" ><span 
class="cmtt-12">https://bitbucket.org/krumholz/vader/downloads</span></a></span>.
<!--l. 77--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-60003.2"></a>Dependencies and Build Requirements</h4>
<!--l. 79--><p class="noindent" ><span 
class="cmtt-12">VADER</span>&#x00A0;has the following dependencies:
      <ul class="itemize1">
      <li class="itemize">The core c routines require the GNU scientific library (GSL) version <span 
class="cmsy-10x-x-120">&#x2265; </span>1.12.
      </li>
      <li class="itemize">The Python wrapper routines require Python <span 
class="cmsy-10x-x-120">&#x2265; </span>2.6 (3.x also ok)
      </li>
      <li class="itemize">The Python wrapper routines require numPy <span 
class="cmsy-10x-x-120">&#x2265; </span>1.6.1
      </li>
      <li class="itemize">The Python wrapper routines require sciPy <span 
class="cmsy-10x-x-120">&#x2265; </span>0.7.0</li></ul>
<!--l. 86--><p class="noindent" ><span 
class="cmtt-12">VADER</span>&#8217;s builtin <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">Makefile</span></span></span> expects that the GSL headers will be included in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">C_INCLUDE_PATH</span></span></span>, and the
object files included in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">LD_LIBRARY_PATH</span></span></span>. If this is not the case, they can be added to the build
path manually by editing the file <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/Makefile</span></span></span>. The <span 
class="cmtt-12">VADER</span>&#x00A0;build system also
expects the environment variables <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">CC</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MAKE</span></span></span> to be set, or to default to reasonable
values.
<!--l. 89--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-70004"></a>Structure of a <span 
class="cmtt-12">VADER </span>Simulation</h3>
<!--l. 92--><p class="noindent" >A <span 
class="cmtt-12">VADER </span>simulation is generally composed of several elements. Not all of these are strictly
mandatory, but they will typically be found in most simulations.
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-7002x1"><span 
class="cmbx-12">Initialize  the  Grid.  </span>Almost  all  <span 
class="cmtt-12">VADER </span>functions  require  a  <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object
      that  defines  the  computational  grid,  the  rotation  curve  that  goes  with  it,  and  a
      number of ancillary quantities. In the c interface, grids can be allocated using the
      <a 
href="#x1-270009.1.6"><span 
class="cmtt-12">gridAlloc</span></a> function, and can be both allocated and initialized using the <a 
href="#x1-290009.1.8"><span 
class="cmtt-12">gridInit</span></a>,
      <a 
href="#x1-320009.1.11"><span 
class="cmtt-12">gridInitTabulated</span></a>, <a 
href="#x1-300009.1.9"><span 
class="cmtt-12">gridInitFlat</span></a>, and <a 
href="#x1-310009.1.10"><span 
class="cmtt-12">gridInitKeplerian</span></a>.
                                                                                         
                                                                                         
      </li>
      <li 
  class="enumerate" id="x1-7004x2"><span 
class="cmbx-12">Allocate a Workspace. </span>Almost all <span 
class="cmtt-12">VADER </span>routines require a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct wksp</span></a> object
      that provides a workspace for computations. This is allocated by calling the <a 
href="#x1-360009.1.15"><span 
class="cmtt-12">wkspAlloc</span></a>
      function in c.
      </li>
      <li 
  class="enumerate" id="x1-7006x3"><span 
class="cmbx-12">Initialize the Data. </span>The user must declare and initialize arrays to contain the initial
      column density, vertically-integrated pressure, and, if using a complex equation of state,
      internal energy. These will be passed to the main simulation routine.
      </li>
      <li 
  class="enumerate" id="x1-7008x4"><span 
class="cmbx-12">Initialize the Parameters. </span>If the simulations require any additional parameters to
      be passed to the user-specific routines (see <a 
href="#x1-90005.1">Section 5.1</a>), these must be stored in a data
      structure that can be passed by reference.
      </li>
      <li 
  class="enumerate" id="x1-7010x5"><span 
class="cmbx-12">Allocate Arrays to Store Outputs. </span>A <span 
class="cmtt-12">VADER </span>simulation generally returns a series
      of outputs, representing snapshots of the state of the computation at a variety of times.
      The user must allocate memory to store these results.
      </li>
      <li 
  class="enumerate" id="x1-7012x6"><span 
class="cmbx-12">Run the Simulation. </span>The simulation is run via a call to the <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> routine. This
      call runs the simulation and stores the output.
      </li>
      <li 
  class="enumerate" id="x1-7014x7"><span 
class="cmbx-12">Free Memory</span>. In a c simulation, the final step is to free the grid and workspace via
      calls to <a 
href="#x1-280009.1.7"><span 
class="cmtt-12">gridFree</span></a> and <a 
href="#x1-370009.1.16"><span 
class="cmtt-12">wkspFree</span></a>.</li></ol>
<!--l. 103--><p class="indent" >       Example c programs can be found in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/prob</span></span></span> directory; all files in that
directory with names of the form <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">main_PROB.c</span></span></span> are examples. Several of these steps can be omitted
for simulations using the <a 
href="#x1-160007">Python interface (Section 7)</a>, which handles most of the allocation,
de-allocation, and processing of data automatically.
<!--l. 106--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-80005"></a>Setting Up a New Problem</h3>
<!--l. 108--><p class="noindent" >Most users of <span 
class="cmtt-12">VADER </span>will likely want to set up their own simulations, defined by their own choices
of viscosity, equation of state, boundary conditions, and heating and cooling rates. Routines
specific to particular problems are stored in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/prob</span></span></span> subdirectory. To define
a new problem, a user must create one mandatory file, and one optional file, in this
directory.
                                                                                         
                                                                                         
<!--l. 110--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-90005.1"></a>The <span 
class="cmtt-12">userFunc </span>File</h4>
<!--l. 113--><p class="noindent" >The mandatory file must have a name of the form <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_MYPROB.c</span></span></span>, where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MYPROB</span></span></span> is the name
the user wishes to assign to that problem. This file must define the following functions, all of which
take the current state of the simulation as inputs:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">userAlpha</span>: this defines the dimensionless viscosity <span 
class="cmmi-12">&#x03B1; </span>for the problem
      </li>
      <li class="itemize"><span 
class="cmtt-12">userEOS</span>: this defines the equation of state parameters <span 
class="cmmi-12">&#x03B3; </span>and <span 
class="cmmi-12">&#x03B4;</span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">userMassSrc</span>: this defines the column density source function <img 
src="UsersGuide7x.png" alt="&#x02D9;
&#x03A3;"  class="dot" ><sub><span 
class="cmmi-8">src</span></sub>
      </li>
      <li class="itemize"><span 
class="cmtt-12">userIntEnSrc</span>: this defines the internal energy source function <span 
class="cmmi-12">&#x0116;</span><sub><span 
class="cmmi-8">int,src</span></sub>
      </li>
      <li class="itemize"><span 
class="cmtt-12">userIBC</span>: this defines the pressure and enthalpy values at the inner boundary condition
      </li>
      <li class="itemize"><span 
class="cmtt-12">userOBC</span>: this defines the pressure and enthalpy values at the outer boundary condition</li></ul>
<!--l. 122--><p class="noindent" >The full APIs for these functions are given in <a 
href="#x1-380009.2">Section 9.2</a>, and may also be found in the source
file <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/userFunc.h</span></span></span>. The easiest way to create a custom <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_MYPROB.c</span></span></span>
file is probably to copy the existing file <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/prob/userFunc_none.c</span></span></span>, which
defines all the required functions as no-ops that simply print a warning message and then
return.
<!--l. 124--><p class="indent" >       While all these functions must be defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_MYPROB.c</span></span></span>, their actual
implementations can be no-ops, as is the case in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_none.c</span></span></span>. The functions are actually
called only if the appropriate flags are set in calls to the <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, or <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>
routines. For example, if <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is called but the input parameter <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is set to 0, then
<span 
class="cmtt-12">userEOS </span>will never be called, and can safely be left as a no-op function.
<!--l. 126--><p class="indent" >       All of the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routines accept an argument <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">void</span><span 
class="cmtt-12">&#x00A0;*params</span></span></span>, as do the <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>,
<a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, and <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a> routines from which they are called. The <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span> variable can be
used to pass arbitrary data into the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routines, thereby allowing these functions to
depend on additional parameters defined at runtime. The user must simply construct a
structure containing whatever parameters he or she requires, obtain a pointer to that
structure, cast it to void, pass it into <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, or <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and then cast
the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">void</span><span 
class="cmtt-12">&#x00A0;*params</span></span></span> value in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routine back to whatever data type it originally
was.
                                                                                         
                                                                                         
<!--l. 129--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-100005.2"></a>The <span 
class="cmtt-12">main </span>File</h4>
<!--l. 131--><p class="noindent" >The optional file has a name of the form <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">main_MYPROB.c</span></span></span>, where <span 
class="cmtt-12">MYPROB </span>is the same as the name
used for <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_MYPROB.c</span></span></span>. This file contains the <span 
class="cmtt-12">main </span>function for the program. It is required if
the code is compiled in <a 
href="#x1-120006.1">Executable Mode</a> or <a 
href="#x1-130006.2">Debug Mode</a>, but is ignored if the code is compiled in
<a 
href="#x1-140006.3">Dynamically-Linked Library Mode</a>.
<!--l. 133--><p class="indent" >       The <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">main</span></span></span> routine generally follows the simulation structure described in <a 
href="#x1-70004">Section 4</a>. Example
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">main_MYPROB.c</span></span></span> files can be found in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/prob</span></span></span> subdirectory.
<!--l. 136--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-110006"></a>Compiling <span 
class="cmtt-12">VADER</span></h3>
<!--l. 138--><p class="noindent" ><span 
class="cmtt-12">VADER </span>can be compiled either as a standalone executable, or as a dynamically-linked
library. In the latter mode, it can be called from the python interface described in <a 
href="#x1-160007">Section
7</a>.
<!--l. 140--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-120006.1"></a>Executable Mode</h4>
<!--l. 143--><p class="noindent" >To compile <span 
class="cmtt-12">VADER </span>in executable mode, from the main <span 
class="cmtt-12">vader </span>directory type
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
make&#x00A0;exec&#x00A0;PROB=MYPROB
</div>
</td></tr></table>
<!--l. 146--><p class="nopar" > where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MYPROB</span></span></span> is the name of the problem to be compiled. This command causes the files
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/userFunc_MYPROB.c</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/main_MYPROB.c</span></span></span> to be copied into the main
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc</span></span></span> directory and compiled along with the core <span 
class="cmtt-12">VADER</span>&#x00A0;routines. Upon successful
compilation, an executable <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader.ex</span></span></span> is placed in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bin</span></span></span> subdirectory. The code is compiled
without debugging symbols, and with a high level of optimization.
<!--l. 149--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-130006.2"></a>Debug Mode</h4>
<!--l. 152--><p class="noindent" >To compile <span 
class="cmtt-12">VADER </span>in debug mode, from the main <span 
class="cmtt-12">vader </span>directory type
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
make&#x00A0;debug&#x00A0;PROB=MYPROB
</div>
</td></tr></table>
<!--l. 155--><p class="nopar" > where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MYPROB</span></span></span> is the name of the problem to be compiled. The results are identical to those for
compilation in <a 
href="#x1-120006.1">Executable Mode</a>, except that debugging symbols are enabled and optimization is
disabled.
<!--l. 158--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">6.3   </span> <a 
 id="x1-140006.3"></a>Dynamically-Linked Library Mode</h4>
<!--l. 161--><p class="noindent" >To compile <span 
class="cmtt-12">VADER </span>in dynamically-linked library mode, from the main <span 
class="cmtt-12">vader </span>directory
type
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
make&#x00A0;lib&#x00A0;PROB=MYPROB
</div>
</td></tr></table>
<!--l. 164--><p class="nopar" > where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MYPROB</span></span></span> is the name of the problem to be compiled. This causes the file
<br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/userFunc_MYPROB.c</span></span></span>, but <span 
class="cmti-12">not </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc/main_MYPROB.c</span></span></span>, to be copied into the
main <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc</span></span></span> directory and compiled along with the core <span 
class="cmtt-12">VADER</span>&#x00A0;routines. The code is
compiled into a dynamically-linked library, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">libvader.x</span></span></span>, where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span> is the extension appropriate for a
dynamically-linked library on the system where the code is being compiled. The library is copied
into the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bin</span></span></span> subdirectory. The code is compiled at a high level of optimization. If <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">PROB</span></span></span> is not
specified, the default problem is <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">none</span></span></span>, which causes all the <a 
href="#x1-380009.2"><span 
class="cmtt-12">user*</span></a> routines to be no-ops that just
print a warning and then return. When compiled in this mode, the code can still be run
on problems where no user-specific functions are used, and all quantities (viscosity,
equation of state, inner and outer boundary conditions, source functions) are defined by
constants.
<!--l. 167--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">6.4   </span> <a 
 id="x1-150006.4"></a>Testing Mode</h4>
<!--l. 170--><p class="noindent" >Testing mode is an additional option that can be combined with executable, debug, or
dynamically-linked library mode. To compile in testing mode, do add the option <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MODE=TEST</span></span></span> to any
of the compilation commands above, for example
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
make&#x00A0;lib&#x00A0;PROB=MYPROB&#x00A0;MODE=TEST.
</div>
</td></tr></table>
<!--l. 173--><p class="nopar" > This causes the <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> routines to return extra diagnostic
information.
<!--l. 177--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-160007"></a>The Python Interface</h3>
<!--l. 180--><p class="noindent" >When compiled in <a 
href="#x1-140006.3">dynamically-linked library mode</a>, <span 
class="cmtt-12">VADER</span>&#x00A0;can be accessed through a python
interface, which provides a convenient method of parsing parameter files, constructing grids,
running simulations, and processing the results. The Python interface to <span 
class="cmtt-12">VADER</span>&#x00A0;is implemented as
a Python package. From the main <span 
class="cmtt-12">vader </span>directory, the package may be imported via the usual
Python import procedure:
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
import&#x00A0;vader
</div>
</td></tr></table>
<!--l. 183--><p class="nopar" >
<!--l. 185--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-170007.1"></a>Structure of a Python-Based <span 
class="cmtt-12">VADER</span>&#x00A0;Simulation</h4>
<!--l. 187--><p class="noindent" >The Python interface to <span 
class="cmtt-12">VADER</span>&#x00A0;provides several convenient routines to make it easier to set up and
run simulations. The <a 
href="#x1-490009.3.4"><span 
class="cmtt-12">vader.readParam</span></a> function can read and parse parameter files formatted as
described in <a 
href="#x1-180007.2">Section 7.2</a>, and return a dict of parameters. This can then be passed to the
<a 
href="#x1-480009.3.3"><span 
class="cmtt-12">vader.grid</span></a> routine to construct a <a 
href="#x1-480009.3.3"><span 
class="cmtt-12">class grid</span></a> object that contains al the grid information
required to a run a simulation. Finally, once the grid has been constructed and initial conditions
specified, a full simulation can be run through the <a 
href="#x1-470009.3.2"><span 
class="cmtt-12">vader.driver</span></a> routine. This routine processes
the inputs into a format suitable for passing to c, calls the c <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> routine, processes the results
into convenient form, and returns them. The usual structure of a Python-based <span 
class="cmtt-12">VADER</span>&#x00A0;simulation
is:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-17002x1"><span 
class="cmbx-12">Import the </span><span 
class="cmtt-12">VADER </span><span 
class="cmbx-12">package.</span>
      </li>
      <li 
  class="enumerate" id="x1-17004x2"><span 
class="cmbx-12">Read the parameter file. </span>This can be accomplished by
                                                                                         
                                                                                         
      <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
      paramDict&#x00A0;=&#x00A0;vader.readParam(fileName)
</div>
      </td></tr></table>
      <!--l. 193--><p class="nopar" >
      </li>
      <li 
  class="enumerate" id="x1-17006x3"><span 
class="cmbx-12">Construct a grid. </span>This can be accomplished by
                                                                                         
                                                                                         
      <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
      grd&#x00A0;=&#x00A0;vader.grid(paramDict)
</div>
      </td></tr></table>
      <!--l. 197--><p class="nopar" >
      </li>
      <li 
  class="enumerate" id="x1-17008x4"><span 
class="cmbx-12">Initialize the Data. </span>Construct <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy</span></span></span> arrays for the initial column density, pressure, and, if
      using a complex equation of state, internal energy.
      </li>
      <li 
  class="enumerate" id="x1-17010x5"><span 
class="cmbx-12">Initialize Parameters for Passing to c. </span>If using custom <a 
href="#x1-380009.2"><span 
class="cmtt-12">user*</span></a> routines that require
      additional parameters, construct a pointer to them suitable for passing to c. This can be
      done using the standard Python <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ctypes</span></span></span> interface. In the most common case where the
      parameters consist of a series of real numbers, these can be stored in a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy</span></span></span> array, and then
      a pointer to them can be obtained via
                                                                                         
                                                                                         
      <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
      paramPtr&#x00A0;=&#x00A0;ctypes.byref(paramArr.ctypes.
      &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;data_as(ctypes.POINTER(ctypes.c_double)).
      &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;contents)
</div>
      </td></tr></table>
      <!--l. 204--><p class="nopar" > where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramArr</span></span></span> is the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy</span></span></span> array containing the parameter values.
      </li>
      <li 
  class="enumerate" id="x1-17012x6"><span 
class="cmbx-12">Run the simulation. </span>This can be accomplished by
                                                                                         
                                                                                         
      <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
      result&#x00A0;=&#x00A0;vader.driver(tState,&#x00A0;tEnd,&#x00A0;grd,&#x00A0;col,&#x00A0;pres,&#x00A0;paramDict,
      &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nOut=nOut,&#x00A0;c_params=paramPtr)
</div>
      </td></tr></table>
      <!--l. 210--><p class="nopar" > The <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader.driver</span></span></span> routine returns a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> containing the results of the
      simulation.</li></ol>
<!--l. 213--><p class="noindent" >Full APIs for all Python functions are given in <a 
href="#x1-450009.3">Section 9.3</a>.
<!--l. 215--><p class="indent" >       <span 
class="cmbx-12">Important warning: </span>in python mode, the <span 
class="cmtt-12">vader </span>python package creates an interface to
the <span 
class="cmtt-12">VADER</span>&#x00A0;library compiled in <a 
href="#x1-140006.3">dynamically-linked library mode</a> using the functionality provided by
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.ctypeslib.load_library</span></span></span>. At present, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.ctypes</span></span></span> does not provide any way to
&#8220;unload&#8221; or &#8220;reload&#8221; a library. Once a library has been loaded into a particular instance of the
python kernel, there is no way to modify it even if the underlying library is recompiled. This
means that, if you alter and recompile <span 
class="cmtt-12">libvader</span>, you will have to start a new python
kernel for those changes to take effect. There is at present no way to rebuild the library
and then create a new interface to the modified library without restarting the python
kernel.
<!--l. 217--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-180007.2"></a>Parameter Files</h4>
<!--l. 220--><p class="noindent" >The <a 
href="#x1-490009.3.4"><span 
class="cmtt-12">vader.readParam</span></a> function can parse files that describe the setup of <span 
class="cmtt-12">VADER</span>&#x00A0;simulations. The
format of the files is a series of key-value pairs formatted as
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
key&#x00A0;=&#x00A0;value
</div>
</td></tr></table>
<!--l. 223--><p class="nopar" > One such pair can appear per line. Blank lines, or lines for which the first non-whitespace
character is <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">#</span></span></span>, are treated as comments and ignored. Known keys are listed in Table <a 
href="#x1-180011">1<!--tex4ht:ref: tab:keys --></a>. Additional
keys not in the table can be added freely, and will be ignored by <span 
class="cmtt-12">VADER</span>, allowing users to add their
own parameters as they like.
<!--l. 226--><p class="indent" >       Most keys map directly onto the parameters of the same name for the <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> and/or
<a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a> and <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a> routines, and control the operations of those routines as
described in the <a 
href="#x1-210009.1">c APIs</a> below. Some keys allow the special value <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span>. Setting this
value indicates that the quantity in question is not a constant, but instead should be
determined by calling the appropriate <a 
href="#x1-90005.1"><span 
class="cmtt-12">user*</span></a> routine that was compiled with the c code. This
provides a mechanism for accessing problem-specific non-constant values of viscosity,
equation of state, source functions, and boundary conditions. At an implementation
level, if one of the keys that allow it is set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span>, then the corresponding <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">*_func</span></span></span>
parameter passed to the c function will be set to 1; otherwise it will be set to 0, and
the corresponding <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">*_val</span></span></span> parameter will be set to the numerical value specified by the
key.
       <div class="table">
                                                                                         
                                                                                         
<!--l. 229--><p class="indent" >       <a 
 id="x1-180011"></a><hr class="float"><div class="float" 
><table class="float"><tr class="float"><td class="float" 
>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 230--><p class="noindent" >
<div class="tabular"><table class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2"></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3"></colgroup><colgroup id="TBL-2-4g"><col 
id="TBL-2-4"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11"><span 
class="cmbx-8">Key                   </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"  
class="td11"><span 
class="cmbx-8">Meaning                               </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-3"  
class="td11"><span 
class="cmbx-8">Allowed values     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-4"  
class="td11"><span 
class="cmbx-8">Default</span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11"><span 
class="cmtt-8">nr                 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"  
class="td11"><span 
class="cmr-8">Number of cells in the grid              </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11"><span 
class="cmtt-8">rmin               </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"  
class="td11"><span 
class="cmr-8">Inner edge of grid                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11"><span 
class="cmtt-8">rmax               </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"  
class="td11"><span 
class="cmr-8">Outer edge of grid                         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">rot_curve_type</span></span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-2"  
class="td11"><span 
class="cmr-8">Type of rotation curve                   </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">flat</span></span></span><span 
class="cmr-8">, </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">keplerian</span></span></span><span 
class="cmr-8">,     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-4"  
class="td11"><div class="multirow"><!-- rows=2 -->
<span 
class="cmr-8">None</span></div>    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-2"  
class="td11">                                                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-3"  
class="td11"><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">tabulated</span></span></span>       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">rot_curve_velocity</span></span></span> </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-2"  
class="td11"><span 
class="cmr-8">Rotation speed for </span><span 
class="cmtt-8">flat </span><span 
class="cmr-8">rotation      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">rot_curve_mass</span></span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-2"  
class="td11"><span 
class="cmr-8">Mass of central object for </span><span 
class="cmtt-8">keplerian </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-2"  
class="td11"><span 
class="cmr-8">rotation                                       </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">rot_curve_file</span></span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-2"  
class="td11"><span 
class="cmr-8">Name of a text file containing a table</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">str           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-2"  
class="td11"><span 
class="cmr-8">of </span><span 
class="cmmi-8">r v</span><sub><span 
class="cmmi-6">&#x03C6;</span></sub> <span 
class="cmr-8">values for </span><span 
class="cmtt-8">tabulated </span><span 
class="cmr-8">rotation</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-1"  
class="td11"><span 
class="cmtt-8">alpha              </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-2"  
class="td11"><span 
class="cmr-8">Dimensionless viscosity </span><span 
class="cmmi-8">&#x03B1;             </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-1"  
class="td11"><span 
class="cmtt-8">gamma              </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-2"  
class="td11"><span 
class="cmr-8">Equation of state </span><span 
class="cmmi-8">&#x03B3;                    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-1"  
class="td11"><span 
class="cmtt-8">delta              </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-2"  
class="td11"><span 
class="cmr-8">Equation of state </span><span 
class="cmmi-8">&#x03B4;                    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-4"  
class="td11"><span 
class="cmr-8">0          </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">ibc_pres_type</span></span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-2"  
class="td11"><span 
class="cmr-8">Type of pressure boundary condition </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_mass_flux</span></span></span><span 
class="cmr-8">,    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-2"  
class="td11"><span 
class="cmr-8">at grid inner edge                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_torque_flux</span></span></span><span 
class="cmr-8">, </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-4"  
class="td11">           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-2"  
class="td11">                                                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-3"  
class="td11"><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_torque</span></span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-18-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">ibc_pres_val</span></span></span>       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-18-2"  
class="td11"><span 
class="cmr-8">Value for inner pressure boundary    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-18-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-18-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-19-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-19-2"  
class="td11"><span 
class="cmr-8">condition                                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-19-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-19-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-20-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">ibc_enth_type</span></span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-20-2"  
class="td11"><span 
class="cmr-8">Type of enthalpy boundary condition</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-20-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_value</span></span></span><span 
class="cmr-8">,          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-20-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-21-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-21-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-21-2"  
class="td11"><span 
class="cmr-8">at grid inner edge                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-21-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_gradient</span></span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-21-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-22-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-22-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">ibc_enth_val</span></span></span>       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-22-2"  
class="td11"><span 
class="cmr-8">Value for inner enthalpy boundary    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-22-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-22-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-23-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-23-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-23-2"  
class="td11"><span 
class="cmr-8">condition                                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-23-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-23-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-24-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-24-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">obc_pres_type</span></span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-24-2"  
class="td11"><span 
class="cmr-8">Type of pressure boundary condition </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-24-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_mass_flux</span></span></span><span 
class="cmr-8">,    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-24-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-25-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-25-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-25-2"  
class="td11"><span 
class="cmr-8">at grid outer edge                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-25-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_torque_flux</span></span></span><span 
class="cmr-8">, </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-25-4"  
class="td11">           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-26-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-26-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-26-2"  
class="td11">                                                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-26-3"  
class="td11"><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_torque</span></span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-26-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-27-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-27-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">obc_pres_val</span></span></span>       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-27-2"  
class="td11"><span 
class="cmr-8">Value for outer pressure boundary    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-27-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-27-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-28-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-28-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-28-2"  
class="td11"><span 
class="cmr-8">condition                                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-28-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-28-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-29-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-29-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">obc_enth_type</span></span></span>      </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-29-2"  
class="td11"><span 
class="cmr-8">Type of enthalpy boundary condition</span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-29-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_value</span></span></span><span 
class="cmr-8">,          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-29-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-30-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-30-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-30-2"  
class="td11"><span 
class="cmr-8">at grid outer edge                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-30-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">fixed_gradient</span></span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-30-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-31-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-31-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">obc_enth_val</span></span></span>       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-31-2"  
class="td11"><span 
class="cmr-8">Value for outer enthalpy boundary    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-31-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-31-4"  
class="td11"><span 
class="cmr-8">None    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-32-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-32-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-32-2"  
class="td11"><span 
class="cmr-8">condition                                     </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-32-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-32-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-33-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-33-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">mass_src</span></span></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-33-2"  
class="td11"><span 
class="cmr-8">Mass source function                      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-33-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-33-4"  
class="td11"><span 
class="cmr-8">0.0       </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-34-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-34-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">int_en_src</span></span></span>         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-34-2"  
class="td11"><span 
class="cmr-8">Internal energy source function        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-34-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float </span><span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">c_func</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-34-4"  
class="td11"><span 
class="cmr-8">0.0       </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-35-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-35-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">err_tol</span></span></span>            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-35-2"  
class="td11"><span 
class="cmr-8">Implicit solver tolerance                  </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-35-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-35-4"  
class="td11"><span 
class="cmr-8">10</span><sup><span 
class="cmsy-6">-</span><span 
class="cmr-6">6</span></sup>     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-36-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-36-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">dt_tol</span></span></span>             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-36-2"  
class="td11"><span 
class="cmr-8">Maximum change per time step        </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-36-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-36-4"  
class="td11"><span 
class="cmr-8">0.1       </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-37-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-37-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">dt_start</span></span></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-37-2"  
class="td11"><span 
class="cmr-8">Starting time step                         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-37-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-37-4"  
class="td11"><span 
class="cmr-8">-1         </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-38-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-38-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">max_iter</span></span></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-38-2"  
class="td11"><span 
class="cmr-8">Maximum implicit iterations            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-38-3"  
class="td11"><span 
class="cmr-8">Any positive </span><span 
class="cmtt-8">int    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-38-4"  
class="td11"><span 
class="cmr-8">40        </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-39-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-39-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">interp_order</span></span></span>       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-39-2"  
class="td11"><span 
class="cmr-8">Enthalpy interpolation order            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-39-3"  
class="td11"><span 
class="cmr-8">1, 2, or 3                </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-39-4"  
class="td11"><span 
class="cmr-8">2          </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-40-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-40-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">max_dt_increase</span></span></span>    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-40-2"  
class="td11"><span 
class="cmr-8">Maximum time step increase           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-40-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-40-4"  
class="td11"><span 
class="cmr-8">1.5       </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-41-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-41-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">dt_min</span></span></span>             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-41-2"  
class="td11"><span 
class="cmr-8">Minimum time step                       </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-41-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">float         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-41-4"  
class="td11"><span 
class="cmr-8">10</span><sup><span 
class="cmsy-6">-</span><span 
class="cmr-6">15</span></sup>    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-42-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-42-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">max_step</span></span></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-42-2"  
class="td11"><span 
class="cmr-8">Maximum time steps                      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-42-3"  
class="td11"><span 
class="cmr-8">Any </span><span 
class="cmtt-8">int           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-42-4"  
class="td11"><span 
class="cmsy-8">-</span><span 
class="cmr-8">1       </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-43-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-43-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">method</span></span></span>             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-43-2"  
class="td11"><span 
class="cmr-8">Advance method                           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-43-3"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">CN</span></span></span> <span 
class="cmr-8">or </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">BE</span></span></span>           </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-43-4"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">CN</span></span></span>     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-44-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-44-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">verbosity</span></span></span>          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-44-2"  
class="td11"><span 
class="cmr-8">Level of verbosity                          </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-44-3"  
class="td11"><span 
class="cmr-8">0, 1, 2, or 3            </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-44-4"  
class="td11"><span 
class="cmr-8">0          </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-45-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-45-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">bspline_degree</span></span></span>     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-45-2"  
class="td11"><span 
class="cmr-8">Degree of B-spline used for              </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-45-3"  
class="td11"><span 
class="cmr-8">Any </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">int</span></span></span> <span 
class="cmmi-8">&#x003E; </span><span 
class="cmr-8">1           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-45-4"  
class="td11"><span 
class="cmr-8">6          </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-46-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-46-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-46-2"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">tabulated</span></span></span> <span 
class="cmr-8">rotation curves               </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-46-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-46-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-47-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-47-1"  
class="td11"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">bspline_breakpoints</span></span></span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-47-2"  
class="td11"><span 
class="cmr-8">Number of breakpoints in B-spline    </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-47-3"  
class="td11"><span 
class="cmr-8">Any </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">int</span></span></span> <span 
class="cmmi-8">&#x003E; </span><span 
class="cmr-8">1           </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-47-4"  
class="td11"><span 
class="cmr-8">15        </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-48-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-48-1"  
class="td11">                             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-48-2"  
class="td11"><span 
class="cmr-8">fit for </span><span class="obeylines-h"><span class="verb"><span 
class="cmtt-8">tabulated</span></span></span> <span 
class="cmr-8">rotation curves       </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-48-3"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-48-4"  
class="td11">           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-49-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-49-1"  
class="td11">                             </td>
</tr></table></div></div>
<br /> <table class="caption" 
><tr style="vertical-align:baseline;" class="caption"><td class="id">Table&#x00A0;1: </td><td  
class="content"> Pre-defined keys in <span 
class="cmtt-12">VADER</span>&#x00A0;parameter files. Default values indicate the values used
in calls to the c routines if the corresponding key is absent. </td></tr></table><!--tex4ht:label?: x1-180011 -->
                                                                                         
                                                                                         
       </td></tr></table></div><hr class="endfloat" />
       </div>
       <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-190008"></a>The <span 
class="cmtt-12">VADER </span>Test Suite</h3>
<!--l. 296--><p class="noindent" ><span 
class="cmtt-12">VADER</span>&#x00A0;provides a number of tests of code accuracy and performance. These correspond to the tests
published in the <span 
class="cmtt-12">VADER</span>&#x00A0;method paper, Krumholz &amp; Forbes, 2014, submitted to <span 
class="cmti-12">Astronomy &amp;</span>
<span 
class="cmti-12">Computing</span>. The tests are all implemented through the <a 
href="#x1-160007">Python interface</a>, and the scripts to run
them are in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">test</span></span></span> subdirectory of the main <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader</span></span></span> directory. The test scripts provided
are:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">selfsim.py</span>:  this  tests  the  code  against  the  analytic  solution  for  evolution  of  a
      self-similar disk from Lynden-Bell &amp; Pringle (1974, MNRAS, 168, 603)
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">selfsim_resolution.py</span></span></span>: this tests the code against the analytic solution for evolution
      of  a  self-similar  disk  from  Lynden-Bell  &amp;  Pringle  (1974,  MNRAS,  168,  603),  and
      performs a convergence study by running the simulation at a variety of resolutions
      </li>
      <li class="itemize"><span 
class="cmtt-12">ring.py</span>:  this  tests  the  code  against  the  analytic  solution  for  evolution  of  an
      initially-singular ring from Pringle (1981, ARA&amp;A, 19, 137)
      </li>
      <li class="itemize"><span 
class="cmtt-12">gidisk.py</span>:  this  tests  the  code  against  the  analytic  solution  for  a  gravitational
      instability-dominated  disk  from  Krumholz  &amp;  Burkert  (2010,  ApJ,  724,  895),  as
      extended by Forbes, Krumholz, &amp; Burkert (2012, ApJ, 754, 48)
      </li>
      <li class="itemize"><span 
class="cmtt-12">ringrad.py</span>: this tests the code by running the singular ring problem using a complex
      equation of state that includes both gas pressure- and radiation pressure-dominated
      regimes. No analytic solution is known for this case, but a benchmark is provided in
      the method paper against which future runs can be tested
      </li>
      <li class="itemize"><span 
class="cmtt-12">performance.py</span>: this runs the code through a series of performance tests, using the
      self-similar disk and radiation pressure ring test problems; warning: this test takes
      a  while  to  perform,  and  involves  rebuilding  <span 
class="cmtt-12">VADER</span>&#x00A0;a  number  of  times  to  test  the
      performance of various code options that are set at compile- rather than run-time</li></ul>
<!--l. 305--><p class="noindent" >All of these tests can be executed by doing
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
python&#x00A0;TEST_NAME.py
</div>
</td></tr></table>
<!--l. 308--><p class="nopar" > from the main <span 
class="cmtt-12">vader </span>directory. Outputs from tests are placed in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">output</span></span></span> subdirectory of the
main <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader</span></span></span> directory. Outputs consist of plots that can be compared to the published benchmarks
in the methods paper.
<!--l. 312--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-200009"></a>Full Description of All Routines and Data Structures</h3>
<!--l. 314--><p class="noindent" >A general note on naming conventions of arrays. All arrays with <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">_g</span></span></span> at the end of their names are
arrays of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr+2</span></span></span> elements, of which the central <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr</span></span></span> represent values at the centers of the
computational grid, and elements <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">0</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr+1</span></span></span> are ghost cells at the inner and outer
boundary, respectively. Arrays with <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">_h</span></span></span> at the end of their names are arrays of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr+1</span></span></span>
elements representing values at the edges of cells. Arrays with no subscript at the end of
their names have <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr</span></span></span> elements, and represent values at cell centers with no ghost
zones.
<!--l. 316--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">9.1   </span> <a 
 id="x1-210009.1"></a>Core c Routines</h4>
<!--l. 319--><p class="noindent" >All c routines are in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader_csrc</span></span></span> directory.
<!--l. 321--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.1   </span> <a 
 id="x1-220009.1.1"></a>c Data Structures</h5>
<!--l. 324--><p class="noindent" >Data structures used throughout the code are defined in <span 
class="cmtt-12">vader.h</span>. These are:
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
/*&#x00A0;Descriptor&#x00A0;for&#x00A0;a&#x00A0;grid&#x00A0;*/
&#x00A0;<br />typedef&#x00A0;struct&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;unsigned&#x00A0;int&#x00A0;nr;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Number&#x00A0;of&#x00A0;real&#x00A0;cells&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;unsigned&#x00A0;int&#x00A0;linear;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Is&#x00A0;this&#x00A0;a&#x00A0;linear&#x00A0;or&#x00A0;logarithmic&#x00A0;grid?&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*r_g,&#x00A0;*r_h;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Cell&#x00A0;center,&#x00A0;edge&#x00A0;locations&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*dr_g;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Cell&#x00A0;sizes&#x00A0;/&#x00A0;log&#x00A0;sizes&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*area;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Area&#x00A0;of&#x00A0;a&#x00A0;zone&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*vphi_g,&#x00A0;*vphi_h;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Rotation&#x00A0;curve&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*beta_g,&#x00A0;*beta_h;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Logarithmic&#x00A0;index&#x00A0;of&#x00A0;rotation&#x00A0;curve&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*psiEff_g,&#x00A0;*psiEff_h;&#x00A0;/*&#x00A0;Effective&#x00A0;gravitational&#x00A0;potential&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*g_h;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Factor&#x00A0;appearing&#x00A0;in&#x00A0;derivatives&#x00A0;*/
&#x00A0;<br />}&#x00A0;grid;
</div>
</td></tr></table>
<!--l. 339--><p class="nopar" >
<!--l. 341--><p class="indent" >       and
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
/*&#x00A0;Workspace&#x00A0;for&#x00A0;calculations&#x00A0;*/
&#x00A0;<br />typedef&#x00A0;struct&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*pres_g,&#x00A0;*presNew_g,&#x00A0;*colNew,&#x00A0;*colTmp;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*alpha_g,&#x00A0;*hint_g,&#x00A0;*hintL_g,&#x00A0;*hintR_g;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*ppmwksp_g;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*fmLast_h,&#x00A0;*fmNew_h;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*ftLast_h,&#x00A0;*feLast_h;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*massSrcLast,&#x00A0;*massSrcNew,&#x00A0;*intEnSrc;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*eIntTmp,&#x00A0;*eIntNew;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*gammaLast,&#x00A0;*deltaLast,&#x00A0;*gammaNew,&#x00A0;*deltaNew;
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*mSrc,&#x00A0;*eSrc;
&#x00A0;<br />&#x00A0;&#x00A0;gsl_vector&#x00A0;*ud_g,&#x00A0;*ld_g,&#x00A0;*diag_g,&#x00A0;*rhs_g,&#x00A0;*presTmp_g;
&#x00A0;<br />#if&#x00A0;AA_M&#x00A0;&#x003E;&#x00A0;0
&#x00A0;<br />&#x00A0;&#x00A0;double&#x00A0;*colHist,&#x00A0;*presHist,&#x00A0;*eIntHist;
&#x00A0;<br />&#x00A0;&#x00A0;gsl_matrix&#x00A0;*resid,&#x00A0;*cov;
&#x00A0;<br />&#x00A0;&#x00A0;gsl_vector&#x00A0;*constraint,&#x00A0;*aa_wgts;
&#x00A0;<br />#endif
&#x00A0;<br />}&#x00A0;wksp;
</div>
</td></tr></table>
<!--l. 362--><p class="nopar" >
<!--l. 364--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.2   </span> <a 
 id="x1-230009.1.2"></a><span 
class="cmtt-12">advanceBE</span></h5>
<!--l. 367--><p class="noindent" >Defined in <span 
class="cmtt-12">advanceBE.h </span>and <span 
class="cmtt-12">advanceBE.c</span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
double
&#x00A0;<br />advanceBE(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Time&#x00A0;step&#x00A0;and&#x00A0;grid&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;double&#x00A0;dt,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Starting&#x00A0;data&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*col,&#x00A0;double&#x00A0;*pres,&#x00A0;double&#x00A0;*eInt,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Records&#x00A0;of&#x00A0;mass&#x00A0;and&#x00A0;energy&#x00A0;transported&#x00A0;off&#x00A0;grid&#x00A0;and&#x00A0;added
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;by&#x00A0;sources&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*mBnd,&#x00A0;double&#x00A0;*eBnd,&#x00A0;double&#x00A0;*mSrc,&#x00A0;double&#x00A0;*eSrc,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Equation&#x00A0;of&#x00A0;state&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;eos_func,&#x00A0;const&#x00A0;double&#x00A0;gamma_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;delta_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Dimensionless&#x00A0;viscosity&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;alpha_func,&#x00A0;const&#x00A0;double&#x00A0;alpha_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inner&#x00A0;boundary&#x00A0;condition&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;pres_ibc,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;enth_ibc,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;ibc_func,&#x00A0;const&#x00A0;double&#x00A0;ibc_pres_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;ibc_enth_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outer&#x00A0;boundary&#x00A0;condition&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;pres_obc,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;enth_obc,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;obc_func,&#x00A0;const&#x00A0;double&#x00A0;obc_pres_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;obc_enth_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Source&#x00A0;function&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;massSrc_func,&#x00A0;const&#x00A0;double&#x00A0;massSrc_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;intEnSrc_func,&#x00A0;const&#x00A0;double&#x00A0;intEnSrc_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Control&#x00A0;and&#x00A0;method&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;errTol,&#x00A0;const&#x00A0;double&#x00A0;dtTol,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;maxIter,&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;interpOrder,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;noUpdate,&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;verbose,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;wksp&#x00A0;*w,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;User-defined&#x00A0;extra&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Diagnostic&#x00A0;outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;unsigned&#x00A0;int&#x00A0;*itCount
&#x00A0;<br />#ifdef&#x00A0;TESTING_MODE
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;,&#x00A0;double&#x00A0;*resid,&#x00A0;unsigned&#x00A0;int&#x00A0;*rtype,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*advanceTime,&#x00A0;double&#x00A0;*nextIterTime,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*userTime
&#x00A0;<br />#endif
                                                                                         
                                                                                         
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 410--><p class="nopar" >
<!--l. 412--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (INPUT) time at start of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">dt</span>: (INPUT) size of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> that describes the simulation grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>:  (INPUT/OUTPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  containing  the
      column density at the start of the time step; at the end of the routine, it is updated
      to the new column density values
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>: (INPUT/OUTPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements containing the
      vertically-integrated pressure at the start of the time step; at the end of the routine,
      it is updated to the new column pressure values
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT/OUTPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements containing the
      internal energy per unit area at the start of the time step; at the end of the routine, it
      is updated to the new internal energy values. If <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is set to 0, this will not be
      referenced, and can be set to <span 
class="cmtt-12">NULL</span>.
      </li>
      <li class="itemize"><span 
class="cmtt-12">mBnd</span>: (OUTPUT) pointer to a two-element array; the mass advected across the inner
      and outer boundaries of the simulation domain during this time step will be added to
      these two elements, using a sign convention whereby transport in the +<span 
class="cmmi-12">r </span>direction is
      positive
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBnd</span>: (OUTPUT) pointer to a two-element array; the total energy advected across
      the inner and outer boundaries of the simulation domain during this time step will
      be added to these two elements, using a sign convention whereby transport in the +<span 
class="cmmi-12">r</span>
      direction is positive
      </li>
      <li class="itemize"><span 
class="cmtt-12">mSrc</span>: (OUTPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements; the total mass per unit area
      added to/subtracted form each cell by the source terms is added to it. If <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span>
      is 0, this array is not referenced, and may be set to <span 
class="cmtt-12">NULL</span>.
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">eSrc</span>:  (OUTPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements;  the  total  energy  per
      unit area added to/subtracted form each cell by the source terms is added to it. If
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span> are both 0, this array is not referenced, and may
      be set to <span 
class="cmtt-12">NULL</span>.
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-400009.2.2"><span 
class="cmtt-12">userEOS</span></a> should be called to set
      the equation of state parameters
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma_val</span></span></span>: (INPUT) constant value of <span 
class="cmmi-12">&#x03B3;</span>; ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">delta_val</span></span></span>: (INPUT) constant value of <span 
class="cmmi-12">&#x03B4;</span>; ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-390009.2.1"><span 
class="cmtt-12">userAlpha</span></a> should be called to
      set the viscosity
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_val</span></span></span>: (INPUT) constant value of <span 
class="cmmi-12">&#x03B1;</span>; ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_ibc</span></span></span>: (INPUT) type of inner pressure boundary condition; allowed values are
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_MASS_FLUX</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE_FLUX</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_ibc</span></span></span>: (INPUT) type of inner enthalpy boundary condition; allowed values are
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_VALUE</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_GRADIENT</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-410009.2.3"><span 
class="cmtt-12">userIBC</span></a> should be called to set
      the inner boundary condition
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>:  (INPUT)  constant  value  for  the  mass  flux,  torque  flux,  or  torque
      (depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_ibc</span></span></span>) used with the inner pressure boundary condition;
      ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>: (INPUT) constant value for the enthalpy value or enthalpy gradient
      (depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_ibc</span></span></span>) use with the inner enthalpy boundary condition;
      ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span> is non-zero
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_obc</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_ibc</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_obc</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_ibc</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_func</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_pres_val</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_enth_val</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-430009.2.5"><span 
class="cmtt-12">userMassSrc</span></a> should be called
      to set the mass source function
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_val</span></span></span>: (INPUT) constant value of the mass source function; ignored if
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-420009.2.4"><span 
class="cmtt-12">userIntEnSrc</span></a> should be
      called to set the mass source function
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_val</span></span></span>: (INPUT) constant value of the mass source function; ignored if
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">errTol</span>: (INPUT) maximum error in the iterative solver; used to test for convergence
      </li>
      <li class="itemize"><span 
class="cmtt-12">dtTol</span>: (INPUT) maximum fractional change in column density / pressure / internal
      energy in fastest-varying cell; used to estimate the next time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">maxIter</span>: (INPUT) maximum number of iterations allowed in the implicit solver
      </li>
      <li class="itemize"><span 
class="cmtt-12">interpOrder</span>:  (INPUT)  order  of  interpolation  to  use  when  reconstructing  specific
      internal  enthalpy  at  cell  faces;  1  =  piecewise  constant,  2  =  piecewise  linear,  3  =
      piecewise parabolic
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">noUpdate</span>: (INPUT) if this is non-zero, then <span 
class="cmtt-12">col</span>, <span 
class="cmtt-12">pres</span>, <span 
class="cmtt-12">eInt</span>, <span 
class="cmtt-12">mBnd</span>, <span 
class="cmtt-12">eBnd</span>, <span 
class="cmtt-12">mSrc</span>, and
      <span 
class="cmtt-12">eSrc </span>are not altered, but the time step is still computed and returned
      </li>
      <li class="itemize"><span 
class="cmtt-12">verbose</span>: (INPUT) if non-zero, the routine will print the residual and some related
      information after ever iteration
      </li>
      <li class="itemize"><span 
class="cmtt-12">w</span>: (INPUT/OUTPUT) pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct workspace</span></a> object
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) pointer to memory containing user-defined parameters; this memory
      is not touched by this routine, but the pointer is passed to all <a 
href="#x1-390009.2.1"><span 
class="cmtt-12">user*</span></a> routines
      </li>
      <li class="itemize"><span 
class="cmtt-12">itCount</span>: (OUTPUT) number of iterations performed by the implicit solver
      </li>
      <li class="itemize"><span 
class="cmtt-12">resid</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): pointer to an array of <span 
class="cmtt-12">maxIter </span>elements;
      the residual at the end of each iteration is returned in it
      </li>
      <li class="itemize"><span 
class="cmtt-12">rtype</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): pointer to an array of <span 
class="cmtt-12">maxIter </span>elements;
      the type of residual (column density, pressure, or internal energy) at the end of each
      iteration is returned in it
      </li>
      <li class="itemize"><span 
class="cmtt-12">advanceTime</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): pointer to a value measuring the
      time spent in the advance routine, in seconds; this is incremented by the time spent in
      the routine during this call
      </li>
      <li class="itemize"><span 
class="cmtt-12">nextIterTime</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): pointer to a value measuring the
      time spent getting the next iterate (via Anderson acceleration, if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">AA_M</span><span 
class="cmtt-12">&#x00A0;&#x003E;</span><span 
class="cmtt-12">&#x00A0;0</span></span></span>), in seconds;
      this is incremented by the time spent in the routine during this call
      </li>
      <li class="itemize"><span 
class="cmtt-12">userTime</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): pointer to a value measuring the time
      spent in the <a 
href="#x1-90005.1"><span 
class="cmtt-12">user*</span></a> routines, in seconds; this is incremented by the time spent in the
      routine during this call
      </li>
      <li class="itemize">Return value: estimate for the size of the next time step; if convergence fails, the return
      value is <span 
class="cmsy-10x-x-120">-</span>1<span 
class="cmmi-12">.</span>0</li></ul>
                                                                                         
                                                                                         
<!--l. 461--><p class="indent" >       The <span 
class="cmtt-12">advanceBE </span>routine advances the simulation through a single time step using backwards
Euler differencing. The arrays <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eInt</span></span></span> specify the state at the start of
the time step, and upon completion of a successful time step they are updated to the
new values. The arrays <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mBnd</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eBnd</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mSrc</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eSrc</span></span></span> are incremented by the values of
mass and energy transported across the grid boundaries and added by the source terms
during the time step. The return value is the estimated size of the next time step. If the
iterative solver does not converge within <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">maxIter</span></span></span> iterations, or if the iteration procedure
produces <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">Inf</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">NaN</span></span></span> values before the maximum number of iterations is reached, the code
returns without updating any quantities except <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">itCount</span></span></span>, and the return value is set to
<span 
class="cmsy-10x-x-120">-</span>1<span 
class="cmmi-12">.</span>0.
<!--l. 463--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.3   </span> <a 
 id="x1-240009.1.3"></a><span 
class="cmtt-12">advanceCN</span></h5>
<!--l. 466--><p class="noindent" >Defined in <span 
class="cmtt-12">advanceCN.h </span>and <span 
class="cmtt-12">advanceCN.c</span>.
<!--l. 468--><p class="indent" >       The API for this routine is identical to that for <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>. It differs only in that this
routine uses Crank-Nicolson rather than backwards Euler time centering.
<!--l. 470--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.4   </span> <a 
 id="x1-250009.1.4"></a><span 
class="cmtt-12">applyBC</span></h5>
<!--l. 473--><p class="noindent" >Defined in <span 
class="cmtt-12">applyBC.h </span>and <span 
class="cmtt-12">applyBC.c</span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />applyBC(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Grid&#x00A0;structure&#x00A0;and&#x00A0;viscosity&#x00A0;values&#x00A0;on&#x00A0;grid&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;grid&#x00A0;*grd,&#x00A0;const&#x00A0;double&#x00A0;*alpha_g,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inner&#x00A0;boundary&#x00A0;condition&#x00A0;specifications&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;ibc_pres,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;ibc_enth,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;ibc_pres_val,&#x00A0;const&#x00A0;double&#x00A0;ibc_enth_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outer&#x00A0;boundary&#x00A0;condition&#x00A0;specifications&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;obc_pres,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;obc_enth,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;obc_pres_val,&#x00A0;const&#x00A0;double&#x00A0;obc_enth_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*pres_g,&#x00A0;double&#x00A0;*hint_g,&#x00A0;double&#x00A0;*pIn,&#x00A0;double&#x00A0;*qIn,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*pOut,&#x00A0;double&#x00A0;*qOut
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 490--><p class="nopar" >
<!--l. 492--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> that describes the simulation grid
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_g</span></span></span>: (INPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr+2</span></span></span> values of the viscosity <span 
class="cmmi-12">&#x03B1;</span>.
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres</span></span></span>: (INPUT) type of inner pressure boundary condition; allowed values are
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_MASS_FLUX</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE_FLUX</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth</span></span></span>: (INPUT) type of inner enthalpy boundary condition; allowed values are
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_VALUE</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_GRADIENT</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>: (INPUT) value for the mass flux, torque flux, or torque (depending on
      the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres</span></span></span>) used with the inner pressure boundary condition
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>: (INPUT) value for the enthalpy value or enthalpy gradient (depending
      on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth</span></span></span>) use with the inner enthalpy boundary condition
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_pres</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_enth</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_pres_val</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_enth_val</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_g</span></span></span>:  (INPUT/OUTPUT)  pointer  to  an  array  of  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr+2</span></span></span> values  of  the
      vertically-integrated pressure; on entry, values in elements 1<img 
src="UsersGuide8x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">grd-&#x003E;nr</span> are set to the
      values on the grid, and on return elements 0 and <span 
class="cmtt-12">grd-&#x003E;nr+1 </span>are set to the values
      required to enforce the specified boundary condition
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">hint_g</span></span></span>: (INPUT/OUTPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grd-&#x003E;nr+2</span></span></span> values of the specific
      enthalpy; on entry, values in elements 1<img 
src="UsersGuide9x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">grd-&#x003E;nr</span> are set to the values on the grid,
      and on return elements 0 and <span 
class="cmtt-12">grd-&#x003E;nr+1 </span>are set to the values required to enforce the
      specified boundary condition
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pIn</span></span></span>: (OUTPUT) the inner ghost zone boundary value is set to
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_g[0]</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;*qIn</span><span 
class="cmtt-12">&#x00A0;*</span><span 
class="cmtt-12">&#x00A0;pres_g[1]</span><span 
class="cmtt-12">&#x00A0;+</span><span 
class="cmtt-12">&#x00A0;*pIn</span></span></span>; this variable returns the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pIn</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">qIn</span></span></span>: (OUTPUT) the inner ghost zone boundary value is set to
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_g[0]</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;*qIn</span><span 
class="cmtt-12">&#x00A0;*</span><span 
class="cmtt-12">&#x00A0;pres_g[1]</span><span 
class="cmtt-12">&#x00A0;+</span><span 
class="cmtt-12">&#x00A0;*pIn</span></span></span>: this variable returns the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">qIn</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pOut</span></span></span>: (OUTPUT) same as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pIn</span></span></span>, but for the outer boundary condition
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">qOut</span></span></span>: (OUTPUT) same as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">qIn</span></span></span>, but for the outer boundary condition</li></ul>
<!--l. 514--><p class="indent" >       This routine fills the ghost cells of the arrays <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_g</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">hint_g</span></span></span> based on the input set of
pressure and enthalpy boundary condition types and values.
<!--l. 516--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.5   </span> <a 
 id="x1-260009.1.5"></a><span 
class="cmtt-12">driver</span></h5>
<!--l. 519--><p class="noindent" >Defined in <span 
class="cmtt-12">driver.h </span>and <span 
class="cmtt-12">driver.c</span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
double
&#x00A0;<br />driver(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Time&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;tStart,&#x00A0;const&#x00A0;double&#x00A0;tEnd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;dtStart,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Computational&#x00A0;grid&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Input&#x00A0;data&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*col,&#x00A0;double&#x00A0;*pres,&#x00A0;double&#x00A0;*eInt,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Equation&#x00A0;of&#x00A0;state&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;eos_func,&#x00A0;const&#x00A0;double&#x00A0;gamma_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;delta_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Dimensionless&#x00A0;viscosity&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;alpha_func,&#x00A0;const&#x00A0;double&#x00A0;alpha_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inner&#x00A0;boundary&#x00A0;condition&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;ibc_pres,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;ibc_enth,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;ibc_func,&#x00A0;const&#x00A0;double&#x00A0;ibc_pres_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;ibc_enth_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outer&#x00A0;boundary&#x00A0;condition&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;obc_pres,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;obc_enth,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;obc_func,&#x00A0;const&#x00A0;double&#x00A0;obc_pres_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;obc_enth_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Source&#x00A0;function&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;massSrc_func,&#x00A0;const&#x00A0;double&#x00A0;massSrc_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;intEnSrc_func,&#x00A0;const&#x00A0;double&#x00A0;intEnSrc_val,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Control&#x00A0;and&#x00A0;method&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;errTol,&#x00A0;const&#x00A0;double&#x00A0;dtTol,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;maxIter,&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;interpOrder,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;maxDtIncrease,&#x00A0;const&#x00A0;double&#x00A0;dtMin,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;int&#x00A0;maxStep,&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;useBE,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;verbosity,&#x00A0;const&#x00A0;wksp&#x00A0;*w,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;User-defined&#x00A0;extra&#x00A0;parameters&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;nOut,&#x00A0;double&#x00A0;*tOut,&#x00A0;double&#x00A0;*colOut,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*presOut,&#x00A0;double&#x00A0;*eIntOut,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*mBndOut,&#x00A0;double&#x00A0;*eBndOut,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*mSrcOut,&#x00A0;double&#x00A0;*eSrcOut,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Diagnostic&#x00A0;outputs&#x00A0;*/
                                                                                         
                                                                                         
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;unsigned&#x00A0;long&#x00A0;*nStep,&#x00A0;unsigned&#x00A0;long&#x00A0;*nIter,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;unsigned&#x00A0;long&#x00A0;*nFail
&#x00A0;<br />#ifdef&#x00A0;TESTING_MODE
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;,&#x00A0;double&#x00A0;*residSum,&#x00A0;unsigned&#x00A0;int&#x00A0;*iterStep,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*driverTime,&#x00A0;double&#x00A0;*advanceTime,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*nextIterTime,&#x00A0;double&#x00A0;*userTime
&#x00A0;<br />#endif
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 569--><p class="nopar" >
<!--l. 571--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">tStart</span>: (INPUT) start time of the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">tEnd</span>: (INPUT) end time of the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">dtStart</span>: (INPUT) value of first simulation time step; if set to a value <span 
class="cmsy-10x-x-120">&#x2264; </span>0, this is
      ignored and the size of the first time step is set automatically
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> that describes the simulation grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>:  (INPUT/OUTPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  containing  the
      column density at the start of the simulation; at the end of the routine, it is updated
      to the final column density values
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>: (INPUT/OUTPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements containing the
      vertically-integrated pressure at the start of the simulation; at the end of the routine,
      it is updated to the final column pressure values
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT/OUTPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements containing the
      internal energy per unit area at the start of the simulation; at the end of the routine,
      it is updated to the final internal energy values. If <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is set to 0, this will not
      be referenced, and can be set to <span 
class="cmtt-12">NULL</span>.
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-400009.2.2"><span 
class="cmtt-12">userEOS</span></a> should be called to set
      the equation of state parameters
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma_val</span></span></span>: (INPUT) constant value of <span 
class="cmmi-12">&#x03B3;</span>; ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">delta_val</span></span></span>: (INPUT) constant value of <span 
class="cmmi-12">&#x03B4;</span>; ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-390009.2.1"><span 
class="cmtt-12">userAlpha</span></a> should be called to
      set the viscosity
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_val</span></span></span>: (INPUT) constant value of <span 
class="cmmi-12">&#x03B1;</span>; ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_ibc</span></span></span>: (INPUT) type of inner pressure boundary condition; allowed values are
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_MASS_FLUX</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE_FLUX</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_ibc</span></span></span>: (INPUT) type of inner enthalpy boundary condition; allowed values are
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_VALUE</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_GRADIENT</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-410009.2.3"><span 
class="cmtt-12">userIBC</span></a> should be called to set
      the inner boundary condition
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>:  (INPUT)  constant  value  for  the  mass  flux,  torque  flux,  or  torque
      (depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_ibc</span></span></span>) used with the inner pressure boundary condition;
      ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>: (INPUT) constant value for the enthalpy value or enthalpy gradient
      (depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_ibc</span></span></span>) use with the inner enthalpy boundary condition;
      ignored if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_obc</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres_ibc</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_obc</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">enth_ibc</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_func</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_pres_val</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>, but for the outer boundary
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_enth_val</span></span></span>: (INPUT) identical to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>, but for the outer boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-430009.2.5"><span 
class="cmtt-12">userMassSrc</span></a> should be called
      to set the mass source function
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_val</span></span></span>: (INPUT) constant value of the mass source function; ignored if
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span>: (INPUT) a non-zero value indicates that <a 
href="#x1-420009.2.4"><span 
class="cmtt-12">userIntEnSrc</span></a> should be
      called to set the mass source function
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_val</span></span></span>: (INPUT) constant value of the mass source function; ignored if
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span> is non-zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">errTol</span>: (INPUT) maximum error in the iterative solver; used to test for convergence
      </li>
      <li class="itemize"><span 
class="cmtt-12">dtTol</span>: (INPUT) maximum fractional change in column density / pressure / internal
      energy in fastest-varying cell; used to estimate the next time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">maxIter</span>: (INPUT) maximum number of iterations allowed in the implicit solver
      </li>
      <li class="itemize"><span 
class="cmtt-12">interpOrder</span>:  (INPUT)  order  of  interpolation  to  use  when  reconstructing  specific
      internal  enthalpy  at  cell  faces;  1  =  piecewise  constant,  2  =  piecewise  linear,  3  =
      piecewise parabolic
      </li>
      <li class="itemize"><span 
class="cmtt-12">maxDtIncrease</span>:  (INPUT)  maximum  factor  by  which  the  time  step  is  allowed  to
      increase per time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">dtMin</span>: (INPUT) minimum time step; the simulation terminates if the time step is ever
      smaller than <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dtMin*(tEnd-tStart)</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">maxStep</span>: (INPUT) maximum number of time steps allowed; if the simulation reaches
      this number of time steps, it terminates. Negative values indicate no limit.
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">useBE</span>:   (INPUT)   if   non-zero,   backwards   Euler   updating   is   used;   otherwise
      Crank-Nicolson updating is used
      </li>
      <li class="itemize"><span 
class="cmtt-12">verbosity</span>: (INPUT) level of verbosity in output printing; 0 = no output printed, 1
      = print out time and time step every 100 time steps; 2 = print out time and time
      step every time step; 3 = print out time and time step every time step, and print out
      residual every implicit iteration
      </li>
      <li class="itemize"><span 
class="cmtt-12">w</span>: (INPUT/OUTPUT) pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct workspace</span></a> object
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) pointer to memory containing user-defined parameters; this memory
      is not touched by this routine, but the pointer is passed to all <a 
href="#x1-390009.2.1"><span 
class="cmtt-12">user*</span></a> routines
      </li>
      <li class="itemize"><span 
class="cmtt-12">nOut</span>: (INPUT) number of times at which to store output
      </li>
      <li class="itemize"><span 
class="cmtt-12">tOut</span>: (INPUT) pointer to array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut</span></span></span> times at which to store output
      </li>
      <li class="itemize"><span 
class="cmtt-12">colOut</span>: (OUTPUT) pointer to array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut*grd-&#x003E;nr</span></span></span> elements used to store column
      densities at times specified by <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tOut</span></span></span>. The first output time is stored in the elements
      <span 
class="cmtt-12">0</span><img 
src="UsersGuide10x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">grd-&#x003E;nr-1</span>, the next time in elements <span 
class="cmtt-12">grd-&#x003E;nr</span><img 
src="UsersGuide11x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">2*grd-&#x003E;nr-1</span>, etc.
      </li>
      <li class="itemize"><span 
class="cmtt-12">presOut</span>: (OUTPUT) same as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">colOut</span></span></span>, but used to store vertically-integrated pressures
      </li>
      <li class="itemize"><span 
class="cmtt-12">eIntOut</span>: (OUTPUT) same as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">colOut</span></span></span>, but used to store internal energy per unit area.
      This array is only used if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is non-zero; otherwise it is not referenced, and can
      be set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">NULL</span></span></span>.
      </li>
      <li class="itemize"><span 
class="cmtt-12">mBndOut</span>: (OUTPUT) pointer to array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut*2</span></span></span> elements used to store the cumulative
      mass advected across the inner and outer boundaries of the simulation up to times
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tOut</span></span></span>. The inner and outer boundary values at the first time are stored in elements 0
      and 1, inner and outer boundary values at the second time are in elements 2 and 3,
      etc. The sign convention is such that values <span 
class="cmmi-12">&#x003E; </span>0 indicate transport in the +<span 
class="cmmi-12">r </span>direction.
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBndOut</span>: (OUTPUT) pointer to array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut*2</span></span></span> elements used to store the cumulative
                                                                                         
                                                                                         
      energy transported across the inner and outer boundaries of the simulation up to times
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tOut</span></span></span>. The inner and outer boundary values at the first time are stored in elements 0
      and 1, inner and outer boundary values at the second time are in elements 2 and 3,
      etc. The sign convention is such that values <span 
class="cmmi-12">&#x003E; </span>0 indicate transport in the +<span 
class="cmmi-12">r </span>direction.
      </li>
      <li class="itemize"><span 
class="cmtt-12">mSrcOut</span>: (OUTPUT) pointer to array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut*grd-&#x003E;nr</span></span></span> elements used to store the
      cumulative column density added to every grid cell by the source terms up to times
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tOut</span></span></span>. The first time values are stored in elements <span 
class="cmtt-12">0</span><img 
src="UsersGuide12x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">grd-&#x003E;nr-1</span>, the next time in
      elements <span 
class="cmtt-12">grd-&#x003E;nr</span><img 
src="UsersGuide13x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">2*grd-&#x003E;nr-1</span>, etc. This array is only referenced if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span>
      is non-zero; otherwise it may be set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">NULL</span></span></span>.
      </li>
      <li class="itemize"><span 
class="cmtt-12">mSrcOut</span>: (OUTPUT) pointer to array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut*grd-&#x003E;nr</span></span></span> elements used to store the
      cumulative energy per unit area added to every grid cell by the source terms up to times
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tOut</span></span></span>. The first time values are stored in elements <span 
class="cmtt-12">0</span><img 
src="UsersGuide14x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">grd-&#x003E;nr-1</span>, the next time in
      elements <span 
class="cmtt-12">grd-&#x003E;nr</span><img 
src="UsersGuide15x.png" alt="&#x22C5;&#x22C5;&#x22C5;"  class="cdots" ><span 
class="cmtt-12">2*grd-&#x003E;nr-1</span>, etc. This array is only referenced if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span>
      or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span> is non-zero; otherwise it may be set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">NULL</span></span></span>.
      </li>
      <li class="itemize"><span 
class="cmtt-12">nStep</span>: (OUTPUT) total number of time steps taken during the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (OUTPUT) total number of implicit iterations performed during the simulation,
      summed over all time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nFail</span>:  (OUTPUT)  total  number  of  times  the  implicit  solver  failed  to  converge,
      necessitating a reduction in the time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">residSum</span>:  (OUTPUT,  only  in  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>):  pointer  to  an  array  of  <span 
class="cmtt-12">maxIter</span>
      elements; the value of the residual after <span 
class="cmmi-12">N </span>iterations, summed over all simulation time
      steps, is stored in element <span 
class="cmmi-12">N</span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">iterStep</span>:  (OUTPUT,  only  in  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>):  pointer  to  an  array  of  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">maxStep</span></span></span>
      elements; returns the number of implicit iterations performed in each time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">driverTime</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): returns the time spent in the driver
      routine, in seconds
      </li>
      <li class="itemize"><span 
class="cmtt-12">advanceTime</span>:  (OUTPUT,  only  in  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>):  returns  the  time  spent  in  the
      advance routine, in seconds
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">nextIterTime</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): returns the time spent the next
      iterate (via Anderson acceleration, if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">AA_M</span><span 
class="cmtt-12">&#x00A0;&#x003E;</span><span 
class="cmtt-12">&#x00A0;0</span></span></span>) in the implicit solver, in seconds
      </li>
      <li class="itemize"><span 
class="cmtt-12">userTime</span>: (OUTPUT, only in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">TESTING_MODE</span></span></span>): returns the time spent in the <a 
href="#x1-90005.1"><span 
class="cmtt-12">user*</span></a>
      routines, in seconds
      </li>
      <li class="itemize">Return  value:  the  final  time  in  the  simulation;  equal  to  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tEnd</span></span></span> if  the  simulation
      successfully ran to completion</li></ul>
<!--l. 632--><p class="indent" >       This is the main simulation driver routine. The user specifies the simulation start and end
times, the initial state of the column density, pressure, and internal energy (if needed), as
well as parameters describing the equation of state, viscosity, boundary conditions, and
source terms. The routine then runs the simulation, storing the state of the simulation
periodically at times specified by the user. On return, the column density, pressure, and
internal energy arrays are updated to their values at the end of the simulation. If the
simulation takes too many time steps, or the time step drops below the specified limit, the
simulation terminates early; in this case the final state of the simulation is stored in
the last slot of the output arrays, and the time at which the simulation terminated is
returned.
<!--l. 634--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.6   </span> <a 
 id="x1-270009.1.6"></a><span 
class="cmtt-12">gridAlloc</span></h5>
<!--l. 637--><p class="noindent" >Defined in <span 
class="cmtt-12">init.h </span>and <span 
class="cmtt-12">init.c</span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
grid&#x00A0;*gridAlloc(const&#x00A0;unsigned&#x00A0;int&#x00A0;nr);
</div>
</td></tr></table>
<!--l. 641--><p class="nopar" >
<!--l. 643--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of grid cells
      </li>
      <li class="itemize">Return value: a pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object that is allocated but uninitialized</li></ul>
<!--l. 649--><p class="indent" >       This routine allocates memory for a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object. The object is uninitialized.
<!--l. 651--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.7   </span> <a 
 id="x1-280009.1.7"></a><span 
class="cmtt-12">gridFree</span></h5>
<!--l. 654--><p class="noindent" >Defined in <span 
class="cmtt-12">init.h </span>and <span 
class="cmtt-12">init.c</span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void&#x00A0;gridFree(grid&#x00A0;*grd);
</div>
</td></tr></table>
<!--l. 658--><p class="nopar" >
<!--l. 660--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">grd</span>: the grid to be freed</li></ul>
<!--l. 665--><p class="indent" >       This routine de-allocates memory for a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object.
<!--l. 668--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.8   </span> <a 
 id="x1-290009.1.8"></a><span 
class="cmtt-12">gridInit</span></h5>
<!--l. 671--><p class="noindent" >Defined in <span 
class="cmtt-12">init.h </span>and <span 
class="cmtt-12">init.c</span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
grid&#x00A0;*gridInit(const&#x00A0;unsigned&#x00A0;int&#x00A0;nr,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*r_g,&#x00A0;const&#x00A0;double&#x00A0;*r_h,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*vphi_g,&#x00A0;const&#x00A0;double&#x00A0;*vphi_h,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*beta_g,&#x00A0;const&#x00A0;double&#x00A0;*beta_h,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*psiEff_g,&#x00A0;const&#x00A0;double&#x00A0;*psiEff_h,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*g_h,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;linear);
</div>
</td></tr></table>
<!--l. 681--><p class="nopar" >
<!--l. 683--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of grid cells
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_g</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+2 </span>values giving the cell-center positions of
      each grid cell, including two ghost zones; must be sorted in strictly increasing order
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_h</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+1 </span>values giving the edge positions of each grid
      cell, excluding the ghost zones; must be sorted in strictly increasing order
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vphi_g</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+2 </span>values giving rotation curve velocities
      <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> at cell centers, including two ghost cells
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vphi_h</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+1 </span>values giving rotation curve velocities
      <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> at cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">beta_g</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+2 </span>values giving values of <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>at
      cell centers, including two ghost cells
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">beta_h</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+1 </span>values giving values of <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>at
      cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psiEff_g</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+2 </span>values giving values of the potential
      plus orbital energy per unit mass <span 
class="cmmi-12">&#x03C8;</span><sub><span 
class="cmmi-8">eff</span></sub> = <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-12">&#x2215;</span>2+<span 
class="cmmi-12">&#x03C8; </span>at cell centers, including two ghost
      cells
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psiEff_h</span></span></span>: (INPUT) pointer to an array of <span 
class="cmtt-12">nr+1 </span>values giving values of the potential
      plus orbital energy per unit mass <span 
class="cmmi-12">&#x03C8;</span><sub><span 
class="cmmi-8">eff</span></sub> = <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmmi-12">&#x2215;</span>2 + <span 
class="cmmi-12">&#x03C8; </span>at cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">g_h</span></span></span>:  (INPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">nr+1 </span>values  giving  the  derivative  factor
      2<span 
class="cmmi-12">&#x03C0;&#x2215;</span>[<span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub>(1 + <span 
class="cmmi-12">&#x03B2;</span>)]<span 
class="cmmi-12">&#x2215;</span>(<span 
class="cmmi-12">r</span>&#x0394; ln <span 
class="cmmi-12">r</span>) (for logarithmic grids) or 2<span 
class="cmmi-12">&#x03C0;&#x2215;</span>[<span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub>(1 + <span 
class="cmmi-12">&#x03B2;</span>)]<span 
class="cmmi-12">&#x2215;r </span>(for linear grids)
      evaluated at cell edges
      </li>
      <li class="itemize"><span 
class="cmtt-12">linear</span>: (INPUT) a non-zero value indicates that the grid should be treated as linear
      for the purposes of taking derivatives and making interpolations; a value of 0 indicates
      that the grid should be treated as logarithmic
      </li>
      <li class="itemize">Return value: a pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object that is allocated and initialized using
      the values in the input quantities</li></ul>
<!--l. 699--><p class="indent" >       This routine constructs a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object from the specified input values. This routine
is the most general grid construction routine, as it allows the user to manually specify every
quantity on the grid.
<!--l. 701--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.9   </span> <a 
 id="x1-300009.1.9"></a><span 
class="cmtt-12">gridInitFlat</span></h5>
<!--l. 704--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
grid&#x00A0;*gridInitFlat(const&#x00A0;unsigned&#x00A0;int&#x00A0;nr,&#x00A0;const&#x00A0;double&#x00A0;rmin,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;rmax,&#x00A0;const&#x00A0;double&#x00A0;vphi,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;linear);
</div>
</td></tr></table>
<!--l. 710--><p class="nopar" >
<!--l. 712--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of grid cells
      </li>
      <li class="itemize"><span 
class="cmtt-12">rmin</span>: (INPUT) radius of the inner edge of the innermost grid cell
      </li>
      <li class="itemize"><span 
class="cmtt-12">rmax</span>: (INPUT) radius of the outer edge of the outermost grid cell
      </li>
      <li class="itemize"><span 
class="cmtt-12">vphi</span>: (INPUT) constant rotation curve speed
      </li>
      <li class="itemize"><span 
class="cmtt-12">linear</span>: (INPUT) a non-zero value indicates that the grid should be treated as linear
      for the purposes of taking derivatives and making interpolations; a value of 0 indicates
      that the grid should be treated as logarithmic
      </li>
      <li class="itemize">Return value: a pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object that is allocated and initialized using
      the values in the input quantities</li></ul>
<!--l. 722--><p class="indent" >       This routine constructs a grid of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> cells from <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmin</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmax</span></span></span>, spaced uniformly linearly or
logarithmically in radius, depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">linear</span></span></span>. The rotation curve on the grid is flat,
with a constant value <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vphi</span></span></span>.
<!--l. 724--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.10   </span> <a 
 id="x1-310009.1.10"></a><span 
class="cmtt-12">gridInitKeplerian</span></h5>
<!--l. 727--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
grid&#x00A0;*gridInitKeplerian(const&#x00A0;unsigned&#x00A0;int&#x00A0;nr,&#x00A0;const&#x00A0;double&#x00A0;rmin,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;rmax,&#x00A0;const&#x00A0;double&#x00A0;m,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;linear);
</div>
</td></tr></table>
<!--l. 733--><p class="nopar" >
<!--l. 735--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of grid cells
      </li>
      <li class="itemize"><span 
class="cmtt-12">rmin</span>: (INPUT) radius of the inner edge of the innermost grid cell
      </li>
      <li class="itemize"><span 
class="cmtt-12">rmax</span>: (INPUT) radius of the outer edge of the outermost grid cell
      </li>
      <li class="itemize"><span 
class="cmtt-12">m</span>: (INPUT) mass of central object, in CGS units
      </li>
      <li class="itemize"><span 
class="cmtt-12">linear</span>: (INPUT) a non-zero value indicates that the grid should be treated as linear
      for the purposes of taking derivatives and making interpolations; a value of 0 indicates
      that the grid should be treated as logarithmic
      </li>
      <li class="itemize">Return value: a pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object that is allocated and initialized using
      the values in the input quantities</li></ul>
<!--l. 745--><p class="indent" >       This routine constructs a grid of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> cells from <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmin</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmax</span></span></span>, spaced uniformly linearly or
logarithmically in radius, depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">linear</span></span></span>. The rotation curve is Keplerian, with
a central object of mass <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">m</span></span></span>.
<!--l. 747--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.11   </span> <a 
 id="x1-320009.1.11"></a><span 
class="cmtt-12">gridInitTabulated</span></h5>
<!--l. 750--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
grid&#x00A0;*gridInitTabulated(const&#x00A0;unsigned&#x00A0;int&#x00A0;nr,&#x00A0;const&#x00A0;double&#x00A0;*rTab,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*vTab,&#x00A0;const&#x00A0;int&#x00A0;nTab,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;rmin,&#x00A0;const&#x00A0;double&#x00A0;rmax,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;bspline_degree,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;bspline_breakpoints,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;linear);
</div>
</td></tr></table>
<!--l. 759--><p class="nopar" >
<!--l. 761--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of grid cells
      </li>
      <li class="itemize"><span 
class="cmtt-12">rTab</span>: (INPUT) pointer to an array of tabulated radii
      </li>
      <li class="itemize"><span 
class="cmtt-12">vTab</span>: (INPUT) pointer to an array of tabulated <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> values
      </li>
      <li class="itemize"><span 
class="cmtt-12">nTab</span>: (INPUT) number of elements in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rTab</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vTab</span></span></span> arrays
      </li>
      <li class="itemize"><span 
class="cmtt-12">rmin</span>: (INPUT) radius of the inner edge of the innermost grid cell
      </li>
      <li class="itemize"><span 
class="cmtt-12">rmax</span>: (INPUT) radius of the outer edge of the outermost grid cell
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bspline_degree</span></span></span>:  (INPUT)  degree  of  the  basis  spline  fit  used  to  interpolate  the
      tabulated rotation curve
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bspline_breakpoints</span></span></span>: (INPUT) number of breakpoints in the basis spline fit used to
      interpolate the tabulated rotation curve
      </li>
      <li class="itemize"><span 
class="cmtt-12">linear</span>: (INPUT) a non-zero value indicates that the grid should be treated as linear
      for the purposes of taking derivatives and making interpolations; a value of 0 indicates
      that the grid should be treated as logarithmic
                                                                                         
                                                                                         
      </li>
      <li class="itemize">Return value: a pointer to a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object that is allocated and initialized using
      the values in the input quantities</li></ul>
<!--l. 775--><p class="indent" >       This routine constructs a grid of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> cells from <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmin</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmax</span></span></span>, spaced uniformly
linearly or logarithmically in radius, depending on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">linear</span></span></span>. The rotation
curve on the grid, and its derivative and integral (the potential), are determined by
constructing a basis spline interpolation, using the specified number of breakpoints
and degree, to the input table of (<span 
class="cmmi-12">r,v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub>) values. The input values must satisfy <span 
class="cmtt-12">nTab &#x003E;=</span>
<span 
class="cmtt-12">bspline</span><span 
class="cmtt-12">_breakpoints + bspline</span><span 
class="cmtt-12">_degree - 2</span>, and the smallest and largest values in
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rTab</span></span></span> must be such that the centers of all grid cells (including ghost cells) are between
them.
<!--l. 777--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.12   </span> <a 
 id="x1-330009.1.12"></a><span 
class="cmtt-12">ppmExtrap</span></h5>
<!--l. 780--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ppmExtrap.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ppmExtrap.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void&#x00A0;ppmExtrap(const&#x00A0;int&#x00A0;nx,&#x00A0;const&#x00A0;double&#x00A0;*dx,&#x00A0;double&#x00A0;*v,&#x00A0;double&#x00A0;*vL,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*vR,&#x00A0;double&#x00A0;*workspace);
</div>
</td></tr></table>
<!--l. 785--><p class="nopar" >
<!--l. 787--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nx</span>: (INPUT) number of array elements
      </li>
      <li class="itemize"><span 
class="cmtt-12">dx</span>: (INPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nx</span></span></span> elements giving the sizes of array cells
      </li>
      <li class="itemize"><span 
class="cmtt-12">v</span>: (INPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nx</span></span></span> elements giving average values in cells
      </li>
      <li class="itemize"><span 
class="cmtt-12">vL</span>: (OUTPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nx</span></span></span> elements giving values at cell left edges
      </li>
      <li class="itemize"><span 
class="cmtt-12">vR</span>: (OUTPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nx</span></span></span> elements giving values at cell right edges
      </li>
      <li class="itemize"><span 
class="cmtt-12">workspace</span>: (INPUT/OUTPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nx</span></span></span> elements that can be used
      as workspace</li></ul>
<!--l. 797--><p class="indent" >       This routine implements the Colella &amp; Woodward (1984, J.&#x00A0;Comp.&#x00A0;Phys., 54, 174-201)
piecewise parabolic method for estimating quantities on the left and right sides of cell interfaces
from the cell-averaged values on a non-uniform grid. The inputs are the number of cells, their
sizes, and their average values, while the outputs are the values at the cell left and right
edges.
<!--l. 799--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.13   </span> <a 
 id="x1-340009.1.13"></a><span 
class="cmtt-12">rotCurveSpline</span></h5>
<!--l. 802--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rotCurveSpline.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rotCurveSpline.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />rotCurveSpline(const&#x00A0;double&#x00A0;*rTab,&#x00A0;const&#x00A0;double&#x00A0;*vTab,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;nTab,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;bspline_degree,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;bspline_breakpoints,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*r,&#x00A0;const&#x00A0;unsigned&#x00A0;int&#x00A0;nr,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*vphi,&#x00A0;double&#x00A0;*psi,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*beta);
</div>
</td></tr></table>
<!--l. 813--><p class="nopar" >
<!--l. 815--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">rTab</span>: (INPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nTab</span></span></span> elements giving radial positions in the data
      table; must be ordered from lowest to highest radius
      </li>
      <li class="itemize"><span 
class="cmtt-12">vTab</span>: (INPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nTab</span></span></span> elements giving rotation curve velocities
      <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> in the data table
      </li>
      <li class="itemize"><span 
class="cmtt-12">nTab</span>: (INPUT) number of entries in the input data table
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bspline_degree</span></span></span>:  (INPUT)  degree  of  the  basis  spline  fit  used  to  interpolate  the
      tabulated rotation curve
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bspline_breakpoints</span></span></span>: (INPUT) number of breakpoints in the basis spline fit used to
      interpolate the tabulated rotation curve
      </li>
      <li class="itemize"><span 
class="cmtt-12">r</span>: (INPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> radii at which interpolated values are to be
      computed; must be ordered from lowest to highest radius
      </li>
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of radii at which interpolated values are to be computed
      </li>
      <li class="itemize"><span 
class="cmtt-12">vphi</span>: (OUTPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> at which interpolated values of <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> are to
      be stored
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">psi</span>:  (OUTPUT)  pointer  to  an  array  of  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> at  which  interpolated  values  of  the
      gravitational potential <span 
class="cmmi-12">&#x03C8; </span>are to be stored
      </li>
      <li class="itemize"><span 
class="cmtt-12">beta</span>: (OUTPUT) pointer to an array of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span> at which interpolated values of the rotation
      curve index <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>are to be stored</li></ul>
<!--l. 829--><p class="indent" >       This function takes a table of (<span 
class="cmmi-12">r,v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub>) values as inputs and uses basis spline interpolation to
construct a fitting function to them. This fitting function is then used to generate a series of
interpolated <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub> values, and a corresponding set of gravitational potential <span 
class="cmmi-12">&#x03C8; </span>and rotation curve
index <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>values at a specified set of fitting points. The gravitational potential is
computed in a gauge where <span 
class="cmmi-12">&#x03C8; </span>= 0 at the outermost fitting point. The input data table and fitting
points must be <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rTab[0]</span><span 
class="cmtt-12">&#x00A0;&#x003C;=</span><span 
class="cmtt-12">&#x00A0;r[0]=</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rTab[nTab-1]</span><span 
class="cmtt-12">&#x00A0;&#x003E;=</span><span 
class="cmtt-12">&#x00A0;r[nr-1]</span></span></span>. The quantities
<span 
class="cmtt-12">bspline</span><span 
class="cmtt-12">_breakpoints </span>and <span 
class="cmtt-12">bspline</span><span 
class="cmtt-12">_degree </span>specify how many breakpoints there should be in the
b-spline fit, and what degree the fit should be, and must satisfy <span 
class="cmtt-12">nTab &#x003E;= bspline</span><span 
class="cmtt-12">_breakpoints +</span>
<span 
class="cmtt-12">bspline</span><span 
class="cmtt-12">_degree - 2</span>. Optimal choices of these parameters depend on the nature of the input
data: sparsely-sampled, noisy data should choose smaller values, while well-sampled, low-noise data
should use larger values.
<!--l. 831--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.14   </span> <a 
 id="x1-350009.1.14"></a><span 
class="cmtt-12">testingMode</span></h5>
<!--l. 834--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">testingMode.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
int&#x00A0;testingMode();
</div>
</td></tr></table>
<!--l. 838--><p class="nopar" >
<!--l. 840--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize">Return value: this function returns 1 if the code was compiled with <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">MODE=TEST</span></span></span>, 0
      otherwise</li></ul>
<!--l. 845--><p class="indent" >       This function provides a way of determining whether the code was compiled in testing
mode, so that the appropriate interface to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> can be
selected.
<!--l. 847--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.15   </span> <a 
 id="x1-360009.1.15"></a><span 
class="cmtt-12">wkspAlloc</span></h5>
<!--l. 850--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
wksp&#x00A0;*wkspAlloc(const&#x00A0;unsigned&#x00A0;int&#x00A0;nr);
</div>
</td></tr></table>
<!--l. 854--><p class="nopar" >
<!--l. 856--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">nr</span>: (INPUT) number of grid cells in the workspace
      </li>
      <li class="itemize">Return value: a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct wksp</span></a> object for which memory has been allocated.</li></ul>
<!--l. 862--><p class="indent" >       This routine allocated memory for a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct wksp</span></a> object.
<!--l. 864--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.1.16   </span> <a 
 id="x1-370009.1.16"></a><span 
class="cmtt-12">wkspFree</span></h5>
<!--l. 867--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void&#x00A0;wkspFree(wksp&#x00A0;*w);
</div>
</td></tr></table>
<!--l. 871--><p class="nopar" >
<!--l. 873--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">w</span>: pointer to the <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct wksp</span></a> object to be de-allocated.</li></ul>
<!--l. 878--><p class="indent" >       This routine de-allocates a <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct wksp</span></a> object.
<!--l. 881--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">9.2   </span> <a 
 id="x1-380009.2"></a>User-Implemented c Routines</h4>
<!--l. 884--><p class="noindent" >All the routines in this section are problem-dependent, and it is up to the user to implement code
for these routines that matches the specified API and defines the physical model to be used in his
or her simulation. All of these routines take an argument <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span>, of type <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">void</span><span 
class="cmtt-12">&#x00A0;*</span></span></span>. The
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routines are all called from <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>; these routines
also accept the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span> argument, and they simply pass it on to the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routines.
This argument is provided to make it possible to pass arbitrary information into the
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routines. It is up to the user to cast this pointer to the appropriate data structure
and to parse the data to which it points. If no additional parameters are needed in the
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">user*</span></span></span> routines, the user may simply choose not to reference the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span> argument, and
may then pass <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">NULL</span></span></span> to the corresponding argument slot in <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or
<a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>.
<!--l. 886--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.2.1   </span> <a 
 id="x1-390009.2.1"></a><span 
class="cmtt-12">userAlpha</span></h5>
<!--l. 889--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_PROB.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />userAlpha(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*col,&#x00A0;const&#x00A0;double&#x00A0;*pres,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*eInt,&#x00A0;const&#x00A0;double&#x00A0;*gamma,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*delta,&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*alpha
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 902--><p class="nopar" >
<!--l. 904--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (INPUT) current simulation time
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to the <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object for the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>: (INPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current column
      densities on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>:  (INPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  giving  the  current
      vertically-integrated pressures on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current internal
      energy  per  unit  area  on  the  grid;  note  that  this  array  is  updated  and  contains
      meaningful data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or
      <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">gamma</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B3; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">delta</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B4; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) a pointer to a block of memory containing parameters
      </li>
      <li class="itemize"><span 
class="cmtt-12">alpha</span>:  (OUTPUT)  pointer  to  an  array  of   <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  containing  the
      dimensionless viscosity <span 
class="cmmi-12">&#x03B1; </span>at every grid cell center</li></ul>
<!--l. 917--><p class="indent" >       The routine receives as inputs the current state of the simulation, including the time, grid,
and values of all quantities being evolved (column density, vertically-integrated pressure, internal
energy per unit area) and all quantities derives from them (equation of state parameters <span 
class="cmmi-12">&#x03B3;</span>, <span 
class="cmmi-12">&#x03B4;</span>).
It also receives whatever data is passed through <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span>. The user must implement
code that, given these inputs, computes the dimensionless viscosity <span 
class="cmmi-12">&#x03B1; </span>at the center
of every grid cell and stores the result in the array <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha</span></span></span>. This routine is called from
hyperref[sssec:advanceBE]<span 
class="cmtt-12">advanceBE</span>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, but only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha_func</span></span></span> is
non-zero.
<!--l. 919--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.2.2   </span> <a 
 id="x1-400009.2.2"></a><span 
class="cmtt-12">userEOS</span></h5>
<!--l. 922--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_PROB.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />userEOS(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*col,&#x00A0;const&#x00A0;double&#x00A0;*pres,&#x00A0;const&#x00A0;double&#x00A0;*eInt,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*gamma,&#x00A0;double&#x00A0;*delta
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 934--><p class="nopar" >
<!--l. 936--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (INPUT) current simulation time
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to the <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object for the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>: (INPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current column
      densities on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>:  (INPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  giving  the  current
      vertically-integrated pressures on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current internal
      energy per unit area on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) a pointer to a block of memory containing parameters
      </li>
      <li class="itemize"><span 
class="cmtt-12">gamma</span>: (OUTPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation
      of state <span 
class="cmmi-12">&#x03B3; </span>value in every grid cell
      </li>
      <li class="itemize"><span 
class="cmtt-12">delta</span>: (OUTPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation
      of state <span 
class="cmmi-12">&#x03B4; </span>value in every grid cell</li></ul>
                                                                                         
                                                                                         
<!--l. 948--><p class="indent" >       The routine receives as inputs the current state of the simulation, including the time, grid,
and values of all quantities being evolved (column density, vertically-integrated pressure, internal
energy per unit area), as well as whatever data is passed through <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span>. The user must
implement code to compute the equation of state parameters <span 
class="cmmi-12">&#x03B3; </span>and <span 
class="cmmi-12">&#x03B4; </span>in every grid cell and store
the result in the arrays <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">delta</span></span></span>. This routine is called from <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and
<a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, but only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> is non-zero.
<!--l. 951--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.2.3   </span> <a 
 id="x1-410009.2.3"></a><span 
class="cmtt-12">userIBC</span></h5>
<!--l. 954--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_PROB.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />userIBC(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*col,&#x00A0;const&#x00A0;double&#x00A0;*pres,&#x00A0;const&#x00A0;double&#x00A0;*eInt,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*gamma,&#x00A0;const&#x00A0;double&#x00A0;*delta,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;ibc_pres,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;ibc_enth,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*ibc_pres_val,&#x00A0;double&#x00A0;*ibc_enth_val
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 968--><p class="nopar" >
<!--l. 970--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (INPUT) current simulation time
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to the <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object for the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>: (INPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current column
      densities on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>:  (INPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  giving  the  current
      vertically-integrated pressures on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current internal
      energy  per  unit  area  on  the  grid;  note  that  this  array  is  updated  and  contains
      meaningful data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or
      <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">gamma</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B3; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">delta</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B4; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) a pointer to a block of memory containing parameters
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres</span></span></span>: (INPUT) the type of pressure boundary condition being used; will be one
      of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_MASS_FLUX</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE_FLUX</span></span></span>, or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_TORQUE</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth</span></span></span>: (INPUT) the type of enthalpy boundary condition being used; will be one
      of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_VALUE</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">FIXED_ENTHALPY_GRADIENT</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>: (OUTPUT) value of the inner pressure boundary condition; depend
      on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres</span></span></span> this will be interpreted as a value for the mass flux across
      the boundary, the torque flux across the boundary, or the torque in the ghost zone
      adjacent to the boundary
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>: (OUTPUT) value of the inner enthalpy boundary condition; depend
      on the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth</span></span></span> this will be interpreted as a value for the either the internal
      enthalpy in the first ghost zone, or for the gradient of internal enthalpy at the inner
      cell edge</li></ul>
<!--l. 986--><p class="indent" >       The routine receives as inputs the current state of the simulation, including the time, grid,
and values of all quantities being evolved (column density, vertically-integrated pressure, internal
energy per unit area) and all quantities derives from them (equation of state parameters <span 
class="cmmi-12">&#x03B3;</span>, <span 
class="cmmi-12">&#x03B4;</span>). It
also receives whatever data is passed through <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span>. The user must implement code that
computes the value of the inner pressure and specific enthalpy boundary conditions, and stores
those values in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_val</span></span></span>. The way that these values will be interpreted
depends on the values of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth</span></span></span>, which specify whether the value expected is, for
pressure, a mass flux, a torque flux, or an absolute torque, and, for enthalpy, whether it is an
value of the specific enthalpy or a value for the gradient of specific enthalpy. For all
fluxes, the sign convention is that positive values indicate transport in the +<span 
class="cmmi-12">r </span>direction.
This routine is called from <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, but only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_func</span></span></span> is
non-zero.
                                                                                         
                                                                                         
<!--l. 988--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.2.4   </span> <a 
 id="x1-420009.2.4"></a><span 
class="cmtt-12">userIntEnSrc</span></h5>
<!--l. 991--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_PROB.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />userIntEnSrc(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*col,&#x00A0;const&#x00A0;double&#x00A0;*pres,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*eInt,&#x00A0;const&#x00A0;double&#x00A0;*gamma,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*delta,&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*intEnSrc
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 1003--><p class="nopar" >
<!--l. 1005--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (INPUT) current simulation time
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to the <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object for the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>: (INPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current column
      densities on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>:  (INPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  giving  the  current
      vertically-integrated pressures on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current internal
      energy  per  unit  area  on  the  grid;  note  that  this  array  is  updated  and  contains
      meaningful data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or
      <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">gamma</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B3; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">delta</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B4; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) a pointer to a block of memory containing parameters
      </li>
      <li class="itemize"><span 
class="cmtt-12">intEnSrc</span>: (OUTPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the value of the
      source term for internal energy per unit area in each cell</li></ul>
<!--l. 1018--><p class="indent" >       The routine receives as inputs the current state of the simulation, including the time, grid,
and values of all quantities being evolved (column density, vertically-integrated pressure, internal
energy per unit area) and all quantities derives from them (equation of state parameters <span 
class="cmmi-12">&#x03B3;</span>, <span 
class="cmmi-12">&#x03B4;</span>). It
also receives whatever data is passed through <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span>. The user must implement code that
computes the source term for internal energy per unit area <span 
class="cmmi-12">&#x0116;</span><sub><span 
class="cmmi-8">int,src</span></sub> in each cell and stores those
values in the array <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc</span></span></span>. This routine is called from <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, but
only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">intEnSrc_func</span></span></span> is non-zero.
<!--l. 1020--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.2.5   </span> <a 
 id="x1-430009.2.5"></a><span 
class="cmtt-12">userMassSrc</span></h5>
<!--l. 1023--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_PROB.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />userMassSrc(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*col,&#x00A0;const&#x00A0;double&#x00A0;*pres,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*eInt,&#x00A0;const&#x00A0;double&#x00A0;*gamma,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*delta,&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*massSrc
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 1035--><p class="nopar" >
<!--l. 1037--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (INPUT) current simulation time
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd</span>: (INPUT) pointer to the <a 
href="#x1-220009.1.1"><span 
class="cmtt-12">struct grid</span></a> object for the simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">col</span>: (INPUT) pointer to an array of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current column
      densities on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres</span>:  (INPUT)  pointer  to  an  array  of  <span 
class="cmtt-12">grd-&#x003E;nr </span>elements  giving  the  current
      vertically-integrated pressures on the grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current internal
      energy  per  unit  area  on  the  grid;  note  that  this  array  is  updated  and  contains
      meaningful data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or
      <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">gamma</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B3; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">delta</span>: (INPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the current equation of
      state <span 
class="cmmi-12">&#x03B4; </span>value in every grid cell; note that this array is updated and contains meaningful
      data only if the value of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eos_func</span></span></span> passed to <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, or <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> is not
      zero
      </li>
      <li class="itemize"><span 
class="cmtt-12">params</span>: (INPUT) a pointer to a block of memory containing parameters
      </li>
      <li class="itemize"><span 
class="cmtt-12">massSrc</span>: (OUTPUT) pointer to an array of <span 
class="cmtt-12">grd-&#x003E;nr </span>elements giving the value of the
      source term for mass per unit area in each cell</li></ul>
<!--l. 1050--><p class="indent" >       The routine receives as inputs the current state of the simulation, including the time, grid,
and values of all quantities being evolved (column density, vertically-integrated pressure, internal
energy per unit area) and all quantities derives from them (equation of state parameters <span 
class="cmmi-12">&#x03B3;</span>, <span 
class="cmmi-12">&#x03B4;</span>). It
also receives whatever data is passed through <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">params</span></span></span>. The user must implement code that
computes the source term for mass per unit area <img 
src="UsersGuide16x.png" alt="&#x03A3;&#x02D9;"  class="dot" ><sub><span 
class="cmmi-8">src</span></sub> in each cell and stores those values in the
array <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc</span></span></span>. This routine is called from <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, but only if
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">massSrc_func</span></span></span> is non-zero.
<!--l. 1052--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.2.6   </span> <a 
 id="x1-440009.2.6"></a><span 
class="cmtt-12">userOBC</span></h5>
<!--l. 1055--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc.h</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">userFunc_PROB.c</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
void
&#x00A0;<br />userOBC(
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Inputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;t,&#x00A0;const&#x00A0;grid&#x00A0;*grd,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*col,&#x00A0;const&#x00A0;double&#x00A0;*pres,&#x00A0;const&#x00A0;double&#x00A0;*eInt,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;double&#x00A0;*gamma,&#x00A0;const&#x00A0;double&#x00A0;*delta,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;const&#x00A0;pres_bc_type&#x00A0;obc_pres,&#x00A0;const&#x00A0;enth_bc_type&#x00A0;obc_enth,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;void&#x00A0;*params,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;/*&#x00A0;Outputs&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;double&#x00A0;*obc_pres_val,&#x00A0;double&#x00A0;*obc_enth_val
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;);
</div>
</td></tr></table>
<!--l. 1069--><p class="nopar" >
<!--l. 1071--><p class="indent" >       The API and parameter definitions are identical to the corresponding ones for
<a 
href="#x1-410009.2.3"><span 
class="cmtt-12">userIBC</span></a>, except that this routine is applied to the outer rather than the inner boundary
condition. It is called from <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a>, <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a>, and <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a>, but only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_func</span></span></span> is
non-zero.
<!--l. 1074--><p class="noindent" >
       <h4 class="subsectionHead"><span class="titlemark">9.3   </span> <a 
 id="x1-450009.3"></a>Python Routines</h4>
<!--l. 1077--><p class="noindent" >All Python routines are defined by files in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test</span></span></span> subdirectories of the main
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader</span></span></span> directory.
<!--l. 1079--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.1   </span> <a 
 id="x1-460009.3.1"></a><span 
class="cmtt-12">vader.advance</span></h5>
<!--l. 1082--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">interface.py</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;advance(t,&#x00A0;dt,&#x00A0;grd,&#x00A0;col,&#x00A0;pres,&#x00A0;paramDict,&#x00A0;eInt=None,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;no_update=False,&#x00A0;c_params=None,&#x00A0;**kwargs):
</div>
</td></tr></table>
<!--l. 1087--><p class="nopar" >
<!--l. 1089--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">t</span>: (<span 
class="cmtt-12">float</span>, INPUT) time at start of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">dt</span>: (<span 
class="cmtt-12">float</span>, INPUT) size of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd </span>: (<a 
href="#x1-480009.3.3"><span 
class="cmtt-12">class grid</span></a>, INPUT) grid object describing the simulation grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">col </span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT/OUTPUT) array of starting column densities; on return,
      contains column densities at end of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres </span>:  (<span 
class="cmtt-12">numpy.array</span>,  INPUT/OUTPUT)  array  of  starting  vertically-integrated
      pressures; on return, contains column densities at end of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">paramDict</span>: (<span 
class="cmtt-12">dict</span>, INPUT) dict of simulation parameters; can be set manually, but
      usually returned by <a 
href="#x1-490009.3.4"><span 
class="cmtt-12">vader.readParam</span></a>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT/OUTPUT) array of starting internal energies; must be
      set if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">delta</span></span></span> in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> are specified as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span> instead of constants, ignored
      otherwise
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">no_update</span></span></span>: (<span 
class="cmtt-12">bool</span>, INPUT) if <span 
class="cmtt-12">True</span>, the state quantities will not be altered, and the
      original values will be returned
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_params</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_void_p</span></span></span>, INPUT) pointer to parameters to be passed into the c functions
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kwargs</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span>, INPUT) any additional keywords specified here are appended to the
      <span 
class="cmtt-12">paramDict </span>before the simulation is run
                                                                                         
                                                                                         
      </li>
      <li class="itemize">Return value: the function returns a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> whose elements are described below.</li></ul>
<!--l. 1104--><p class="indent" >       This function calls the c <a 
href="#x1-230009.1.2"><span 
class="cmtt-12">advanceBE</span></a> or <a 
href="#x1-240009.1.3"><span 
class="cmtt-12">advanceCN</span></a> routine, depending on the value of
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">method</span></span></span> in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span>. Other values in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> are used to set the corresponding arguments
in the c functions. The return value of the function is a <span 
class="cmtt-12">namedtuple </span>whose elements
are:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">success</span>: (<span 
class="cmtt-12">bool</span>) <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">True</span></span></span> if the iteration converged, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">False</span></span></span> if not
      </li>
      <li class="itemize"><span 
class="cmtt-12">dtNew</span>: (<span 
class="cmtt-12">float</span>) estimated value of next time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (<span 
class="cmtt-12">long</span>) number of implicit iterations performed
      </li>
      <li class="itemize"><span 
class="cmtt-12">mBnd</span>: (<span 
class="cmtt-12">numpy.array, shape (2)</span>) mass transported across inner and outer boundaries
      during this time step; positive values indicate transport in +<span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBnd</span>:   (<span 
class="cmtt-12">numpy.array, shape (2)</span>)   energy   transported   across   inner   and   outer
      boundaries during this time step; positive values indicate transport in +<span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">mSrc</span>: (<span 
class="cmtt-12">numpy array, shape (grd.nr)</span>) mass column density added to each cell by
      the source terms during this time step; returned only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mass_src</span></span></span> is set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span> in
      <span 
class="cmtt-12">paramDict</span>; otherwise this is <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eSrc</span>: (<span 
class="cmtt-12">numpy array, shape (grd.nr)</span>) energy per unit area added to each cell by the
      source terms during this time step; returned only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mass_src</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">int_en_src</span></span></span> is set to
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span> in <span 
class="cmtt-12">paramDict</span>; otherwise this is <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">resid</span>:   (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(paramDict[&#8217;max_iter&#8217;])</span></span></span>)   residual   after   each
      iteration; returned only if the code is compiled in <a 
href="#x1-150006.4">Testing Mode</a>
      </li>
      <li class="itemize"><span 
class="cmtt-12">rtype</span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array</span><span 
class="cmtt-12">&#x00A0;of</span><span 
class="cmtt-12">&#x00A0;uintc,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(paramDict[&#8217;max_iter&#8217;])</span></span></span>) indicates if the
      maximum residual after each iteration was in column density, pressure, or internal
      energy, with 1 = column density, 2 = pressure, 3 = internal energy; returned only if
      the code is compiled in <a 
href="#x1-150006.4">Testing Mode</a></li></ul>
                                                                                         
                                                                                         
<!--l. 1117--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.2   </span> <a 
 id="x1-470009.3.2"></a><span 
class="cmtt-12">vader.driver</span></h5>
<!--l. 1120--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">interface.py</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;driver(tStart,&#x00A0;tEnd,&#x00A0;grd,&#x00A0;col,&#x00A0;pres,&#x00A0;paramDict,&#x00A0;nOut=50,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;outTimes=None,&#x00A0;eInt=None,&#x00A0;c_params=None,&#x00A0;**kwargs):
</div>
</td></tr></table>
<!--l. 1125--><p class="nopar" >
<!--l. 1127--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">tStart</span>: (<span 
class="cmtt-12">float</span>, INPUT) time at start of simulation
      </li>
      <li class="itemize"><span 
class="cmtt-12">tEnd</span>: (<span 
class="cmtt-12">float</span>, INPUT) simulation end time
      </li>
      <li class="itemize"><span 
class="cmtt-12">grd </span>: (<a 
href="#x1-480009.3.3"><span 
class="cmtt-12">class grid</span></a>, INPUT) grid object describing the simulation grid
      </li>
      <li class="itemize"><span 
class="cmtt-12">col </span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT/OUTPUT) array of starting column densities; on return,
      contains column densities at end of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">pres </span>:  (<span 
class="cmtt-12">numpy.array</span>,  INPUT/OUTPUT)  array  of  starting  vertically-integrated
      pressures; on return, contains column densities at end of time step
      </li>
      <li class="itemize"><span 
class="cmtt-12">paramDict</span>: (<span 
class="cmtt-12">dict</span>, INPUT) dict of simulation parameters; can be set manually, but
      usually returned by <a 
href="#x1-490009.3.4"><span 
class="cmtt-12">vader.readParam</span></a>
      </li>
      <li class="itemize"><span 
class="cmtt-12">nOut</span>: (<span 
class="cmtt-12">int</span>, INPUT) number of times at which to store output; outputs are only stored
      if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut</span><span 
class="cmtt-12">&#x00A0;&#x003E;=</span><span 
class="cmtt-12">&#x00A0;1</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">outTimes</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT) exact times at which to store output; if set, this
      overrides <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eInt</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT/OUTPUT) array of starting internal energies; must be
      set if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">delta</span></span></span> in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> are specified as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span> instead of constants, ignored
      otherwise
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_params</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_void_p</span></span></span>, INPUT) pointer to parameters to be passed into the c functions
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kwargs</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span>, INPUT) any additional keywords specified here are appended to the
      <span 
class="cmtt-12">paramDict </span>before the simulation is run
      </li>
      <li class="itemize">Return value: the function returns a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> whose elements are described below.</li></ul>
<!--l. 1143--><p class="indent" >       This function calls the c <a 
href="#x1-260009.1.5"><span 
class="cmtt-12">driver</span></a> routine, using the values in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> to set the call
parameters. If <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nOut</span></span></span> is <span 
class="cmsy-10x-x-120">&#x2265; </span>1 and <span 
class="cmtt-12">outTimes </span>is not set, then the array of output times passed
to the c routine is automatically set to an array of values uniformly spaced in time
from <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tStart</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tEnd</span></span></span>. The return value of the function is a <span 
class="cmtt-12">namedtuple </span>whose elements
are:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">tFin</span>: (<span 
class="cmtt-12">float</span>) time at which simulation ended
      </li>
      <li class="itemize"><span 
class="cmtt-12">tOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>) times at which output is stored
      </li>
      <li class="itemize"><span 
class="cmtt-12">colOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) 2D array of column densities stored
      at specified times
      </li>
      <li class="itemize"><span 
class="cmtt-12">presOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) 2D array of vertically-integrated
      pressures stored at specified times
      </li>
      <li class="itemize"><span 
class="cmtt-12">eIntOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) 2D array of internal energies per
      unit area stored at specified times; returned only if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">delta</span></span></span> in <span 
class="cmtt-12">paramDict </span>are
      set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span>; otherwise this is <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">mBndOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>) cumulative mass transported across the
      inner and outer boundaries up to the specified time; positive values indicate transport
      in the +<span 
class="cmmi-12">r </span>direction, negative values indicate transport in the <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBndOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>)  cumulative  energy  transported  across
      the  inner  and  outer  boundaries  up  to  the  specified  time;  positive  values  indicate
      transport in the +<span 
class="cmmi-12">r </span>direction, negative values indicate transport in the <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">mSrcOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) cumulative mass column density
      added  to  each  cell  by  the  source  terms  up  to  the  specified  time;  returned  only  if
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mass_src</span></span></span> in <span 
class="cmtt-12">paramDict </span>is set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span>; otherwise this is <span 
class="cmtt-12">None</span>
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">eSrcOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) cumulative energy per unit area
      added  to  each  cell  by  the  source  terms  up  to  the  specified  time;  returned  only  if
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mass_src</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">int_en_src</span></span></span> in <span 
class="cmtt-12">paramDict </span>is set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_func</span></span></span>; otherwise this is <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">nStep</span>: (<span 
class="cmtt-12">long</span>) total number of simulation time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (<span 
class="cmtt-12">long</span>) total number of implicit iterations, summed over all time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nFail</span>: (<span 
class="cmtt-12">long</span>) total number of times the implicit solver failed to converge
      </li>
      <li class="itemize"><span 
class="cmtt-12">residSum</span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(paramDict[&#8217;max_iter&#8217;])</span></span></span>) sum of residuals after
      a given iteration number, summed over all time steps; returned only if the code is
      compiled in <a 
href="#x1-150006.4">Testing Mode</a>
      </li>
      <li class="itemize"><span 
class="cmtt-12">iterStep</span>:     (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array</span><span 
class="cmtt-12">&#x00A0;of</span><span 
class="cmtt-12">&#x00A0;uintc,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(paramDict[&#8217;max_step&#8217;])</span></span></span>):     total
      number of iterations performed in each time step; returned only if the code is compiled
      in <a 
href="#x1-150006.4">Testing Mode</a></li></ul>
<!--l. 1162--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.3   </span> <a 
 id="x1-480009.3.3"></a><span 
class="cmtt-12">vader.grid</span></h5>
<!--l. 1165--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">grid.py</span></span></span>.
<!--l. 1167--><p class="indent" >       This is a class with the following attributes:
      <ul class="itemize1">
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nr</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">int</span></span></span>) number of cells
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape(grd.nr)</span></span></span>) cell center positions
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape(grd.nr+1)</span></span></span>) cell edge positions
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_g</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape(grd.nr+2)</span></span></span>) cell center positions, including ghost zones at
      the inner and outer edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">linear</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bool</span></span></span>) <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">True</span></span></span> for linearly-spaced grids, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">False</span></span></span> for logarithmically spaced
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dr</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) cell sizes, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dr</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;r_h[1:]</span><span 
class="cmtt-12">&#x00A0;-</span><span 
class="cmtt-12">&#x00A0;r_h[:-1]</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dr_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>) cell center to cell center distances,
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dr_h</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;r_g[1:]</span><span 
class="cmtt-12">&#x00A0;-</span><span 
class="cmtt-12">&#x00A0;r_g[:-1]</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dlnr</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) logarithmic cell sizes,
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dlnr</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;ln(r_h[1:]/r_h[:-1])</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dlnr_h</span></span></span>:  (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>)  logarithmic  cell  center  to  cell  center
      distances, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dlnr_h</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;ln(r_g[1:]/r_g[:-1])</span></span></span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">area</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) cell areas
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vphi</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) rotation curve velocities at cell centers
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vphi_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>) rotation curve velocities at cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vphi_g</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+2)</span></span></span>) rotation curve velocities at cell centers,
      including ghost zones
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">beta</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) rotation curve index <span 
class="cmmi-12">&#x03B2; </span>= <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>at cell
      centers
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">beta_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>) rotation curve index <span 
class="cmmi-12">&#x03B2; </span>= <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>at
      cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">beta_g</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+2)</span></span></span>) rotation curve index <span 
class="cmmi-12">&#x03B2; </span>= <span 
class="cmmi-12">d</span> ln <span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub><span 
class="cmmi-12">&#x2215;d</span> ln <span 
class="cmmi-12">r </span>at
      cell centers, including ghost zones
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psi</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) gravitational potential at cell centers
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psi_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>) gravitational potential at cell edges
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psi_g</span></span></span>:  (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+2)</span></span></span>)  gravitational  potential  at  cell  centers,
      including ghost zones
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psiEff</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr)</span></span></span>) gravitational plus orbital energy per unit
      mass at cell centers
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psiEff_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>) gravitational plus orbital energy per
      unit mass at cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">psiEff_g</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+2)</span></span></span>) gravitational plus orbital energy per
      unit mass at cell centers, including ghost zones
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">g_h</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array,</span><span 
class="cmtt-12">&#x00A0;shape</span><span 
class="cmtt-12">&#x00A0;(grd.nr+1)</span></span></span>) the quantity <span 
class="cmmi-12">g </span>= 2<span 
class="cmmi-12">&#x03C0;&#x2215;</span>[<span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub>(1+<span 
class="cmmi-12">&#x03B2;</span>)&#x0394;<span 
class="cmmi-12">r</span>] (for linear
      grids), or <span 
class="cmmi-12">g </span>= 2<span 
class="cmmi-12">&#x03C0;&#x2215;</span>[<span 
class="cmmi-12">v</span><sub><span 
class="cmmi-8">&#x03C6;</span></sub>(1 + <span 
class="cmmi-12">&#x03B2;</span>)<span 
class="cmmi-12">r</span>&#x0394; ln <span 
class="cmmi-12">r</span>] (for logarithmic grids), computed at cell edges
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_grd</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_void_p</span></span></span>) a pointer to a c <a 
href="#x1-220009.1.1">struct grid</a> object associated with this grid
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_wksp</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">c_void_p</span></span></span>) a pointer to a c <a 
href="#x1-220009.1.1">struct wksps</a> object associated with this grid</li></ul>
<!--l. 1196--><p class="indent" >       The class has one externally-visible function, which uses an input <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> to construct
an instance of the class.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;__init__(self,&#x00A0;paramDict,&#x00A0;rotCurveFun=None,&#x00A0;rotCurveTab=None,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;r_h=None,&#x00A0;r_g=None):
</div>
</td></tr></table>
<!--l. 1200--><p class="nopar" >
<!--l. 1202--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">paramDict</span>: (<span 
class="cmtt-12">dict</span>, INPUT) dict of simulation parameters; can be set manually, but
      usually returned by <a 
href="#x1-490009.3.4"><span 
class="cmtt-12">vader.readParam</span></a>
      </li>
      <li class="itemize"><span 
class="cmtt-12">rotCurveFun</span>: (<span 
class="cmtt-12">callable</span>, INPUT) a function to compute the rotation curve; it must
      take two arguments: a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array</span></span></span> of positions, and the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span>, and return 3
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array</span></span></span>s giving the rotation curve velocity, the potential, and the index <span 
class="cmmi-12">&#x03B2; </span>at
      the input positions. If this parameter is not <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">None</span></span></span>, then all information related to the
      rotation curve in <span 
class="cmtt-12">paramDict </span>is ignored.
      </li>
      <li class="itemize"><span 
class="cmtt-12">rotCurveTab</span>:   (<span 
class="cmtt-12">numpy.array, shape (2, N)</span>,   INPUT)   an   array   containing   a
      tabulated rotation curve; elements <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">[0,:]</span></span></span> give the positions, and elements <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">[1,:]</span></span></span> give
      the velocities at those positions. If this parameter is not <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">None</span></span></span>, then all information
      related to the rotation curve in <span 
class="cmtt-12">paramDict </span>is ignored.
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_h</span></span></span>: (<span 
class="cmtt-12">numpy.array, shape (N)</span>) an array of cell edge positions. If this parameter is
      not <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">None</span></span></span>, then all information related to the grid in <span 
class="cmtt-12">paramDict </span>is ignored.
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_g</span></span></span>: (<span 
class="cmtt-12">numpy.array, shape (N+1)</span>) an array of cell center positions, including two
      ghost cells. If this parameter is not <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">None</span></span></span>, then all information related to the grid in
      <span 
class="cmtt-12">paramDict </span>is ignored. This must be set if <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_h</span></span></span> is set, and vice-versa.</li></ul>
<!--l. 1211--><p class="indent" >       This function constructs a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">class</span><span 
class="cmtt-12">&#x00A0;grid</span></span></span> object using the information found in the
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span>. By default the grid is either uniform in linear or logarithmic radius, with edges
specified by <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmin</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rmax</span></span></span> in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span>, but this can be overridden by setting the keywords <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_g</span></span></span>
and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r_h</span></span></span>, allowing arbitrary grids. Similarly, the rotation curve is by default set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">flat</span></span></span>,
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">keplerian</span></span></span>, or <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tabulated</span></span></span>, depending on the value specified in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span>, but this can be
overridden by the user setting the keyword <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rotCurveFun</span></span></span>. This option allows the user to supply an
arbitrary Python callable that returns the rotation curve velocity, potential, and index <span 
class="cmmi-12">&#x03B2; </span>versus
position, and builds the rotation curve from that. The user can construct <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tabulated</span></span></span> rotation
                                                                                         
                                                                                         
curves in two ways. First, the user may supply a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">numpy.array</span></span></span> of shape <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">(2,N)</span></span></span> through the
keyword <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rotCurveTab</span></span></span>. Second, it the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> specifies that the rotation curve is
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tabulated</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rotCurveTab</span></span></span> is <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">None</span></span></span>, the routine expects the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span> to include
the keyword <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">rot_curve_file</span></span></span> specifying the name of an ASCII file containing a series
of <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">r</span><span 
class="cmtt-12">&#x00A0;vphi</span></span></span> values from which the rotation curve table can be read. For either of the
tabulated options, the rotation curve, potential, and index on the computational grid are
constructed by calling <a 
href="#x1-340009.1.13"><span 
class="cmtt-12">rotCurveSpline</span></a> in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">libvader</span></span></span>. The degree and number of breakpoints
in the B-spline fit are controlled by <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bspline_degree</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">bspline_breakpoints</span></span></span> in
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramDict</span></span></span>.
<!--l. 1213--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.4   </span> <a 
 id="x1-490009.3.4"></a><span 
class="cmtt-12">vader.readParam</span></h5>
<!--l. 1216--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">readParam.py</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;readParam(paramFile,&#x00A0;noCheck=False):
</div>
</td></tr></table>
<!--l. 1220--><p class="nopar" >
<!--l. 1222--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">paramFile</span>: (<span 
class="cmtt-12">str</span>, INPUT) name of a parameter file to be read
      </li>
      <li class="itemize"><span 
class="cmtt-12">noCheck</span>: (<span 
class="cmtt-12">bool</span>, INPUT) if <span 
class="cmtt-12">TRUE</span>, the parameter file is not checked to see if it contains
      all the (key, value) pairs required to run a <span 
class="cmtt-12">VADER</span>&#x00A0;simulation
      </li>
      <li class="itemize">Return value: this function returns a <span 
class="cmtt-12">dict </span>containing the (key, value) pairs read from
      the specified file</li></ul>
<!--l. 1229--><p class="indent" >       This routine parses a parameter file. The file is expected to be formatted as described in
<a 
href="#x1-180007.2">Section 7.2</a>. Unless <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">noCheck</span></span></span> is set to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">True</span></span></span>, it also checks that the parameter file contains all the
(key, value) pairs that are mandatory for running a <span 
class="cmtt-12">VADER</span>&#x00A0;simulation; this are <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">alpha</span></span></span>,
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">gamma</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_type</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_enth_type</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_pres_val</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_pres_type</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_enth_type</span></span></span>,
and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_pres_val</span></span></span>, and raises a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ValueError</span></span></span> if a mandatory parameter is found to be
missing. The function returns the parsed file as a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span> suitable for passing to other python
<span 
class="cmtt-12">VADER</span>&#x00A0;routines.
<!--l. 1231--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.5   </span> <a 
 id="x1-500009.3.5"></a><span 
class="cmtt-12">vader.test.gidisk</span></h5>
<!--l. 1234--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/gidisk.py</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;gidisk(paramFile,&#x00A0;nOut=16,&#x00A0;outTimes=None,&#x00A0;verbosity=0,&#x00A0;**kwargs):
</div>
</td></tr></table>
<!--l. 1238--><p class="nopar" >
<!--l. 1240--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">paramFile</span>: (<span 
class="cmtt-12">str</span>, INPUT) name of the parameter file to use
      </li>
      <li class="itemize"><span 
class="cmtt-12">outTimes</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT) array specifying times at which to save output
      </li>
      <li class="itemize"><span 
class="cmtt-12">nOut</span>: (<span 
class="cmtt-12">int</span>, INPUT) number of output times to save, uniformly spaced; ignored if
      <span 
class="cmtt-12">outTimes </span>is not <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kwargs</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span>, INPUT) any additional keywords specified here are appended to the
      <span 
class="cmtt-12">paramDict </span>constructed from <span 
class="cmtt-12">paramFile </span>before the simulation is run
      </li>
      <li class="itemize">Return value: the function returns a <span 
class="cmtt-12">namedtuple </span>whose elements are described below</li></ul>
<!--l. 1249--><p class="indent" >       This function sets up and runs a test comparing <span 
class="cmtt-12">VADER</span>&#8217;s result to the Krumholz &amp; Burkert
(2010, ApJ, 724, 895) analytic solution for a steady-state gravitational instability-dominated disk.
The file <span 
class="cmtt-12">paramFile </span>contains the parameter to use for the run; in addition to the usual ones defined
in Table <a 
href="#x1-180011">1<!--tex4ht:ref: tab:keys --></a>, the parameter file must contain the following keys: <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">eta</span></span></span> gives the dimensionless
turbulence dissipation rate, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">n_orbit</span></span></span> specifies the number of outer orbits to run, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">t_Q</span></span></span> specifies the
timescale on which <span 
class="cmmi-12">Q </span><span 
class="cmsy-10x-x-120">&#x2192; </span>1 in units of the local orbital time, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init_col</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init_vdisp</span></span></span> give the
initial column density and velocity dispersion relative to the steady-state value, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ibc_vdisp</span></span></span> and
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">obc_vdisp</span></span></span> give the velocity dispersion and the inner and outer boundaries relative to the
steady state value, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dt_init</span></span></span> gives the initial time step in units of the outer orbital
time. An example parameter file can be found in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/gidisk.param</span></span></span>. After
the simulation completes, the function returns a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> containing the following
entries:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">x</span>: (<span 
class="cmtt-12">numpy.array, shape (grd.nr)</span>) dimensionless cell center position, in units where
      the outer edge of the disk is at <span 
class="cmmi-12">x </span>= 1
      </li>
      <li class="itemize"><span 
class="cmtt-12">T</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>) output times, in units where the orbital period at
      the disk outer edge is 1
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">colOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  column  density  at  times  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and
      positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, in units where the steady state solution is at the disk edge is 1
      </li>
      <li class="itemize"><span 
class="cmtt-12">presOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  vertically-integrated  pressure  at
      times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, in units where the steady state solution for the column density
      times velocity dispersion squared at the disk edge is 1
      </li>
      <li class="itemize"><span 
class="cmtt-12">Q</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) Toomre <span 
class="cmmi-12">Q </span>at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">colSteady</span>:   (<span 
class="cmtt-12">numpy.array, shape (grd.nr)</span>)   steady-state   solution   for   column
      density versus position <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, in the same dimensionless units as <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">colOut</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">presSteady</span>:        (<span 
class="cmtt-12">numpy.array, shape (grd.nr)</span>)        steady-state        solution
      for vertically-integrated pressure versus position <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, in the same dimensionless units as
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">presOut</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">nStep</span>: (<span 
class="cmtt-12">long</span>) total number of simulation time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (<span 
class="cmtt-12">long</span>) total number of implicit iterations, summed over all time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nFail</span>: (<span 
class="cmtt-12">long</span>) total number of times the implicit solver failed to converge</li></ul>
<!--l. 1263--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.6   </span> <a 
 id="x1-510009.3.6"></a><span 
class="cmtt-12">vader.test.ring</span></h5>
<!--l. 1266--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/ring.py</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;ring(paramFile,&#x00A0;nOut=65,&#x00A0;outTimes=None,&#x00A0;**kwargs):
</div>
</td></tr></table>
<!--l. 1270--><p class="nopar" >
<!--l. 1272--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">paramFile</span>: (<span 
class="cmtt-12">str</span>, INPUT) name of the parameter file to use
      </li>
      <li class="itemize"><span 
class="cmtt-12">outTimes</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT) array specifying times at which to save output
      </li>
      <li class="itemize"><span 
class="cmtt-12">nOut</span>: (<span 
class="cmtt-12">int</span>, INPUT) number of output times to save, uniformly spaced; ignored if
      <span 
class="cmtt-12">outTimes </span>is not <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kwargs</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span>, INPUT) any additional keywords specified here are appended to the
      <span 
class="cmtt-12">paramDict </span>constructed from <span 
class="cmtt-12">paramFile </span>before the simulation is run
      </li>
      <li class="itemize">Return value: the function returns a <span 
class="cmtt-12">namedtuple </span>whose elements are described below</li></ul>
<!--l. 1281--><p class="indent" >       This function tests <span 
class="cmtt-12">VADER</span>&#x00A0;against the Pringle (1981, ARA&amp;A, 19, 137) solution
for the evolution of an initially-singular ring of material. The file <span 
class="cmtt-12">paramFile </span>contains
the parameter to use for the run; in addition to the usual ones defined in Table <a 
href="#x1-180011">1<!--tex4ht:ref: tab:keys --></a>, the
parameter file must contain the following keys: <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ring_mass</span></span></span> gives the mass of the ring,
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init_temp</span></span></span> gives the initial temperature of the gas, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col_ratio</span></span></span> gives the ratio of column
densities between the cell containing the ring and all other cells, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">ring_loc</span></span></span> gives the
location of the ring, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kinematic_visc</span></span></span> gives the kinematic viscosity, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">end_time</span></span></span> gives
the simulation end time in units of <span 
class="cmmi-12">t</span><sub><span 
class="cmmi-8">s</span></sub>, the characteristic viscous evolution time for the
problem. An example parameter file can be found in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/ring.param</span></span></span>.The
function runs the simulation and then returns a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> containing the following
elements:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">x</span>: (<span 
class="cmtt-12">numpy.array, shape (grd.nr)</span>) dimensionless cell center position, in units where
      the initial ring location is <span 
class="cmmi-12">x </span>= 1
      </li>
      <li class="itemize"><span 
class="cmtt-12">tau</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>) output times, in units where the characteristic
      viscous evolution time <span 
class="cmmi-12">t</span><sub><span 
class="cmmi-8">s</span></sub> is 1
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">colOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) column densities at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and
      positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col0</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;ring_mass/(np.pi*ring_loc**2)</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">colExact</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  exact  analytic  solution  for  the
      column density at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col0</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">err</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) fractional error between analytic and
      exact solutions for column density at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">presOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  vertically-integrated  pressure  at
      times  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and  positions  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>,  normalized  to  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres0</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;col0*kB*init_temp/(mu*mH)</span></span></span>,
      where <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kB</span></span></span> is Boltzmann&#8217;s constant, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mH</span></span></span> is the mass of a hydrogen atom, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mu=2.33</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">l1err</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>) <span 
class="cmmi-12">L</span><sup><span 
class="cmr-8">1</span></sup>  norm error on the numerical solution as
      compared to the analytic one, at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">mBndOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>) cumulative mass transported across the
      inner and outer boundaries up to the specified time, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col0*ring_loc**2</span></span></span>;
      positive values indicate transport in the +<span 
class="cmmi-12">r </span>direction, negative values indicate transport
      in the <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">mDiskOut</span>:   (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>)   total   mass   of   all   material   on   the
      computational grid at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col0*ring_loc**2</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBndOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>)  cumulative  energy  transported  across
      the inner and outer boundaries up to the specified time, normalized to
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres0*ring_loc**2*(gamma-1)</span></span></span>; positive values indicate transport in the +<span 
class="cmmi-12">r </span>direction,
      negative values indicate transport in the <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">eDiskOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>)  total  energy  of  all  material  on  the
      computational grid at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres0*ring_loc**2*(gamma-1)</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">nStep</span>: (<span 
class="cmtt-12">long</span>) total number of simulation time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (<span 
class="cmtt-12">long</span>) total number of implicit iterations, summed over all time steps
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">nFail</span>: (<span 
class="cmtt-12">long</span>) total number of times the implicit solver failed to converge</li></ul>
<!--l. 1300--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.7   </span> <a 
 id="x1-520009.3.7"></a><span 
class="cmtt-12">vader.test.ringrad</span></h5>
<!--l. 1303--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/ringrad.py</span></span></span>.
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;ringrad(paramFile,&#x00A0;nOut=65,&#x00A0;outTimes=None,&#x00A0;**kwargs):
</div>
</td></tr></table>
<!--l. 1307--><p class="nopar" >
<!--l. 1309--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">paramFile</span>: (<span 
class="cmtt-12">str</span>, INPUT) name of the parameter file to use
      </li>
      <li class="itemize"><span 
class="cmtt-12">outTimes</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT) array specifying times at which to save output
      </li>
      <li class="itemize"><span 
class="cmtt-12">nOut</span>: (<span 
class="cmtt-12">int</span>, INPUT) number of output times to save, uniformly spaced; ignored if
      <span 
class="cmtt-12">outTimes </span>is not <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kwargs</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span>, INPUT) any additional keywords specified here are appended to the
      <span 
class="cmtt-12">paramDict </span>constructed from <span 
class="cmtt-12">paramFile </span>before the simulation is run
      </li>
      <li class="itemize">Return value: the function returns a <span 
class="cmtt-12">namedtuple </span>whose elements are described below</li></ul>
<!--l. 1318--><p class="indent" >       This function tests <span 
class="cmtt-12">VADER</span>&#x00A0;by running the same setup as <a 
href="#x1-510009.3.6"><span 
class="cmtt-12">vader.test.ring</span></a>, but with an
equation of state that includes contributions from both radiation and gas pressure. The keys
expected in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramFile</span></span></span> are identical to those in the <a 
href="#x1-510009.3.6"><span 
class="cmtt-12">vader.test.ring</span></a> test (except that the key
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init_temp</span></span></span> is renamed <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init_teff</span></span></span>, to better reflect its physical meaning in this test), plus
the additional key <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">f_z0</span></span></span>, which defines the relative importance of radiation and gas
pressure in the initial conditions; see the Krumholz &amp; Forbes method paper for the full
definition. An example parameter file can be found in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/ringrad.param</span></span></span>. The
function runs the simulation and then returns a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> containing the following
elements:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">x</span>: (<span 
class="cmtt-12">numpy.array, shape (grd.nr)</span>) dimensionless cell center position, in units where
      the initial ring location is <span 
class="cmmi-12">x </span>= 1
      </li>
      <li class="itemize"><span 
class="cmtt-12">tau</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>) output times, in units where the characteristic
      viscous evolution time <span 
class="cmmi-12">t</span><sub><span 
class="cmmi-8">s</span></sub> is 1
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">colOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) column densities at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and
      positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">colExact</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  exact  analytic  solution  for  the
      column density at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">err</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) fractional error between analytic and
      exact solutions for column density at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">presOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  vertically-integrated  pressure  at
      times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">pGasOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) vertically-integrated gas pressure
      at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">pRadOut</span>:   (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)   vertically-integrated   radiation
      pressure at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eIntOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) internal energy per unit area at
      times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eGravOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) gravitational potential energy per
      unit area at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eOrbOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) orbital kinetic energy per unit area
      at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) total energy per unit area at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span>
      and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">tempOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) effective temperature <span 
class="cmmi-12">T</span><sub><span 
class="cmmi-8">eff</span></sub> at times
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBndOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>)  cumulative  energy  transported  across
      the  inner  and  outer  boundaries  up  to  the  specified  time;  positive  values  indicate
      transport in the +<span 
class="cmmi-12">r </span>direction, negative values indicate transport in the <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">eDiskOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>)  total  energy  of  all  material  on  the
      computational grid at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">nStep</span>: (<span 
class="cmtt-12">long</span>) total number of simulation time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (<span 
class="cmtt-12">long</span>) total number of implicit iterations, summed over all time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nFail</span>: (<span 
class="cmtt-12">long</span>) total number of times the implicit solver failed to converge</li></ul>
<!--l. 1339--><p class="noindent" >Note that the outputs of this routine differ from those of <a 
href="#x1-510009.3.6"><span 
class="cmtt-12">vader.test.ring</span></a> in that column densities and
pressure for this routine are in physical rather than normalized units.
<!--l. 1342--><p class="noindent" >
       <h5 class="subsubsectionHead"><span class="titlemark">9.3.8   </span> <a 
 id="x1-530009.3.8"></a><span 
class="cmtt-12">vader.test.selfsim</span></h5>
<!--l. 1345--><p class="noindent" >Defined in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/selfsim.py</span></span></span>
                                                                                         
                                                                                         
       <table 
class="verbatim"><tr class="verbatim"><td 
class="verbatim"><div class="verbatim">
def&#x00A0;selfsim(paramFile,&#x00A0;nOut=65,&#x00A0;outTimes=None,&#x00A0;**kwargs):
</div>
</td></tr></table>
<!--l. 1349--><p class="nopar" >
<!--l. 1351--><p class="indent" >       Parameters:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">paramFile</span>: (<span 
class="cmtt-12">str</span>, INPUT) name of the parameter file to use
      </li>
      <li class="itemize"><span 
class="cmtt-12">outTimes</span>: (<span 
class="cmtt-12">numpy.array</span>, INPUT) array specifying times at which to save output
      </li>
      <li class="itemize"><span 
class="cmtt-12">nOut</span>: (<span 
class="cmtt-12">int</span>, INPUT) number of output times to save, uniformly spaced; ignored if
      <span 
class="cmtt-12">outTimes </span>is not <span 
class="cmtt-12">None</span>
      </li>
      <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kwargs</span></span></span>: (<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">dict</span></span></span>, INPUT) any additional keywords specified here are appended to the
      <span 
class="cmtt-12">paramDict </span>constructed from <span 
class="cmtt-12">paramFile </span>before the simulation is run
      </li>
      <li class="itemize">Return value: the function returns a <span 
class="cmtt-12">namedtuple </span>whose elements are described below</li></ul>
<!--l. 1360--><p class="indent" >       This function tests <span 
class="cmtt-12">VADER</span>&#x00A0;by running a simulation that is compared to the analytic solution
of Lynden-Bell &amp; Pringle (1974, MNRAS, 168, 603) for the evolution of a self-similar disk. The
keys expected in the <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">paramFile</span></span></span>, beyond the standard ones defined in Table <a 
href="#x1-180011">1<!--tex4ht:ref: tab:keys --></a>, are:
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">R0</span></span></span>, which gives the initial scale radius, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">nu0</span></span></span>, which gives the kinematic viscosity at the
initial scale radius, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">Mdot0</span></span></span>, which gives the accretion rate onto the central point mass
at 1 viscous evolution time, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">init_temp</span></span></span>, which gives the initial gas temperature, and
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">end_time</span></span></span>, which gives the end time of the simulation in viscous evolution times. An
example parameter file can be found in <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">vader/test/selfsim.param</span></span></span>. The routine runs
the simulation and then returns the results in a <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">namedtuple</span></span></span> containing the following
elements:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmtt-12">x</span>: (<span 
class="cmtt-12">numpy.array, shape (grd.nr)</span>) dimensionless cell center position, in units where
      the initial scale radius is <span 
class="cmmi-12">x </span>= 1
      </li>
      <li class="itemize"><span 
class="cmtt-12">T</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>)  output  times,  in  units  where  the  characteristic
      viscous evolution time <span 
class="cmmi-12">t</span><sub><span 
class="cmmi-8">s</span></sub> is 1
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">colOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  column  densities  at  times  <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and
      positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col1</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;Mdot0/(3*np.pi*nu0)</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">colExact</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  exact  analytic  solution  for  the
      column density at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col1</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">err</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>) fractional error between analytic and
      exact solutions for column density at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">presOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, grd.nr)</span>)  vertically-integrated  pressure  at
      times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span> and positions <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">x</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres1</span><span 
class="cmtt-12">&#x00A0;=</span><span 
class="cmtt-12">&#x00A0;col1*kB*init_temp/(mu*mH)</span></span></span>, where
      <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">kB</span></span></span> is Boltzmann&#8217;s constant, <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mH</span></span></span> is the mass of a hydrogen atom, and <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">mu=2.33</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">l1err</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>) <span 
class="cmmi-12">L</span><sup><span 
class="cmr-8">1</span></sup>  norm error on the numerical solution as
      compared to the analytic one, at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">mBndOut</span>: (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>) cumulative mass transported across the
      inner and outer boundaries up to the specified time, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col1*R0**2</span></span></span>; positive
      values indicate transport in the +<span 
class="cmmi-12">r </span>direction, negative values indicate transport in the
      <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">mDiskOut</span>:   (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>)   total   mass   of   all   material   on   the
      computational grid at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">T</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">col1*R0**2</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">eBndOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut, 2)</span>)  cumulative  energy  transported  across
      the inner and outer boundaries up to the specified time, normalized to
      <br class="newline" /><span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres1*R0**2*(gamma-1)</span></span></span>;  positive  values  indicate  transport  in  the  +<span 
class="cmmi-12">r  </span>direction,
      negative values indicate transport in the <span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">r </span>direction
      </li>
      <li class="itemize"><span 
class="cmtt-12">eDiskOut</span>:  (<span 
class="cmtt-12">numpy.array, shape (nOut)</span>)  total  energy  of  all  material  on  the
      computational grid at times <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">tau</span></span></span>, normalized to <span class="obeylines-h"><span class="verb"><span 
class="cmtt-12">pres1*R0**2*(gamma-1)</span></span></span>
      </li>
      <li class="itemize"><span 
class="cmtt-12">nStep</span>: (<span 
class="cmtt-12">long</span>) total number of simulation time steps
      </li>
      <li class="itemize"><span 
class="cmtt-12">nIter</span>: (<span 
class="cmtt-12">long</span>) total number of implicit iterations, summed over all time steps
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmtt-12">nFail</span>: (<span 
class="cmtt-12">long</span>) total number of times the implicit solver failed to converge</li></ul>
<!--l. 1380--><p class="noindent" >
       <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-5400010"></a>Revision History</h3>
<!--l. 1382--><p class="noindent" >
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-54002x1">Version 1.0, 6/2014 &#8211; initial release</li></ol>
        
</body></html> 

                                                                                         


